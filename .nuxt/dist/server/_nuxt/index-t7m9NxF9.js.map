{"version":3,"file":"index-t7m9NxF9.js","sources":["../../../../lib/wagmi.ts","../../../../components/WalletConnect.vue","../../../../components/BotControl.vue","../../../../components/DelegationCard.vue","../../../../components/DelegationList.vue","../../../../components/HomeDashboard.vue"],"sourcesContent":["import { createConfig, http, injected } from '@wagmi/core'\nimport { base } from '@wagmi/core/chains'\n\nexport const metaMaskConnector = injected({ target: 'metaMask' })\nexport const coinbaseConnector = injected({ target: 'coinbaseWallet' })\n\nexport const wagmiConfig = createConfig({\n  chains: [base],\n  connectors: [metaMaskConnector, coinbaseConnector],\n  transports: {\n    [base.id]: http(),\n  },\n})\n\nexport const AAVEGOTCHI_DIAMOND_ADDRESS = '0xA99c4B08201F2913Db8D28e71d020c4298F29dBF' as const\n\nexport const AAVEGOTCHI_FACET_ABI = [\n  {\n    type: 'function',\n    name: 'isPetOperatorForAll',\n    stateMutability: 'view',\n    inputs: [\n      { name: '_owner', type: 'address' },\n      { name: '_operator', type: 'address' },\n    ],\n    outputs: [{ type: 'bool' }],\n  },\n  {\n    type: 'function',\n    name: 'setPetOperatorForAll',\n    stateMutability: 'nonpayable',\n    inputs: [\n      { name: '_operator', type: 'address' },\n      { name: '_approved', type: 'bool' },\n    ],\n    outputs: [],\n  },\n] as const\n\nexport const AAVEGOTCHI_GAME_FACET_ABI = [\n  {\n    inputs: [{ internalType: 'uint256[]', name: '_tokenIds', type: 'uint256[]' }],\n    name: 'interact',\n    outputs: [],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    inputs: [{ internalType: 'uint256', name: '_tokenId', type: 'uint256' }],\n    name: 'kinship',\n    outputs: [{ internalType: 'uint256', name: '', type: 'uint256' }],\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    inputs: [{ internalType: 'address', name: '_owner', type: 'address' }],\n    name: 'tokenIdsOfOwner',\n    outputs: [{ internalType: 'uint32[]', name: '', type: 'uint32[]' }],\n    stateMutability: 'view',\n    type: 'function',\n  },\n] as const\n","<template>\n  <div class=\"wallet-connect\">\n    <div v-if=\"!isConnected\" class=\"space-y-4\">\n      <p class=\"text-slate-400\">Connect with MetaMask or Coinbase Wallet only</p>\n      <div class=\"flex flex-col sm:flex-row gap-3\">\n        <button\n          @click=\"connectWallet('metaMask')\"\n          :disabled=\"connecting\"\n          class=\"px-6 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed font-medium\"\n        >\n          {{ connecting ? 'Connecting...' : 'MetaMask' }}\n        </button>\n        <button\n          @click=\"connectWallet('coinbaseWallet')\"\n          :disabled=\"connecting\"\n          class=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium\"\n        >\n          {{ connecting ? 'Connecting...' : 'Coinbase Wallet' }}\n        </button>\n      </div>\n      <p v-if=\"error\" class=\"text-red-400 text-sm\">{{ error }}</p>\n      <p v-if=\"error\" class=\"text-slate-400 text-xs mt-1\">\n        Have Uniswap or other wallets? Disable them or use a private window with only MetaMask or Coinbase Wallet.\n      </p>\n    </div>\n    <div v-else class=\"space-y-4\">\n      <div class=\"bg-emerald-500/20 border border-emerald-500/50 rounded-lg p-4\">\n        <p class=\"text-emerald-400 font-medium\">Connected</p>\n        <p class=\"text-slate-300 text-sm mt-1 break-all\">{{ address }}</p>\n      </div>\n      <button\n        v-if=\"!isAuthenticated\"\n        @click=\"signMessage\"\n        :disabled=\"signing\"\n        class=\"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n      >\n        {{ signing ? 'Signing...' : 'Sign Message to Login' }}\n      </button>\n      <button\n        v-else\n        @click=\"disconnectWallet\"\n        class=\"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700\"\n      >\n        Disconnect\n      </button>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\nimport { getAccount, connect, disconnect, signMessage as wagmiSignMessage } from '@wagmi/core'\nimport { wagmiConfig, metaMaskConnector, coinbaseConnector } from '~/lib/wagmi'\n\nconst config = useRuntimeConfig()\nconst allowedAddress = (config.public?.allowedAddress || '0x2127aa7265d573aa467f1d73554d17890b872e76').toLowerCase()\n\nconst address = ref<string>('')\nconst isConnected = ref(false)\nconst isAuthenticated = ref(false)\nconst connecting = ref(false)\nconst signing = ref(false)\nconst error = ref<string>('')\n\nconst checkAuth = async () => {\n  try {\n    const response = await $fetch<{ authenticated: boolean }>('/api/auth/check')\n    isAuthenticated.value = response.authenticated\n  } catch (err) {\n    isAuthenticated.value = false\n  }\n}\n\nconst connectWallet = async (target: 'metaMask' | 'coinbaseWallet') => {\n  connecting.value = true\n  error.value = ''\n\n  try {\n    const connector = target === 'metaMask' ? metaMaskConnector : coinbaseConnector\n    const result = await connect(wagmiConfig, { connector })\n\n    if (result?.accounts?.[0]) {\n      address.value = result.accounts[0]\n      isConnected.value = true\n\n      if (result.accounts[0].toLowerCase() !== allowedAddress) {\n        error.value = `Your address is not whitelisted. Only ${allowedAddress} is allowed.`\n        isConnected.value = false\n      } else {\n        await checkAuth()\n      }\n    }\n  } catch (err: any) {\n    const msg = err?.message || 'Failed to connect wallet'\n    if (msg.includes('Provider not found')) {\n      error.value =\n        'MetaMask/Coinbase not found. Disable Uniswap Wallet and other extensions, or use a private window with only MetaMask or Coinbase.'\n    } else if (msg.includes('ethereum') && msg.includes('getter')) {\n      error.value =\n        'Wallet conflict detected. Try disabling other wallet extensions or use a private window with only MetaMask or Coinbase Wallet.'\n    } else {\n      error.value = msg\n    }\n    isConnected.value = false\n  } finally {\n    connecting.value = false\n  }\n}\n\nconst signMessage = async () => {\n  signing.value = true\n  error.value = ''\n\n  try {\n    const message = `Sign in to Aavegotchi Petter Bot\\n\\nAddress: ${address.value}\\n\\nThis request will not trigger a blockchain transaction or cost any gas fees.`\n\n    const signature = await wagmiSignMessage(wagmiConfig, {\n      message,\n      account: address.value as `0x${string}`,\n    })\n\n    const response = await $fetch<{ success: boolean }>('/api/auth/verify', {\n      method: 'POST',\n      body: {\n        address: address.value,\n        message,\n        signature,\n      },\n    })\n\n    if (response.success) {\n      isAuthenticated.value = true\n      await navigateTo('/')\n    }\n  } catch (err: any) {\n    error.value = err?.message || err?.data?.message || 'Failed to sign message'\n  } finally {\n    signing.value = false\n  }\n}\n\nconst disconnectWallet = async () => {\n  try {\n    await $fetch('/api/auth/logout', { method: 'POST' })\n    await disconnect(wagmiConfig)\n    isConnected.value = false\n    isAuthenticated.value = false\n    address.value = ''\n    await navigateTo('/')\n  } catch (err) {\n    console.error('Failed to disconnect:', err)\n  }\n}\n\nonMounted(async () => {\n  if (typeof window === 'undefined') return\n  const account = getAccount(wagmiConfig)\n  if (account.isConnected && account.address) {\n    address.value = account.address\n    isConnected.value = true\n    await checkAuth()\n  }\n})\n</script>\n","<template>\n  <div class=\"bot-control\">\n    <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6\">\n      <h2 class=\"text-lg font-semibold mb-4\">Bot Control</h2>\n\n      <div v-if=\"loading\" class=\"text-center py-4\">\n        <p class=\"text-slate-400\">Loading...</p>\n      </div>\n\n      <div v-else class=\"space-y-4\">\n        <div class=\"flex items-center justify-between\">\n          <div>\n            <p class=\"text-sm text-slate-400\">Status</p>\n            <p class=\"text-lg font-semibold\" :class=\"status.running ? 'text-emerald-400' : 'text-red-400'\">\n              {{ status.running ? 'Running' : 'Stopped' }}\n            </p>\n          </div>\n          <div v-if=\"status.lastRun\">\n            <p class=\"text-sm text-slate-400\">Last Run</p>\n            <p class=\"text-lg font-semibold\">{{ formatDate(status.lastRun) }}</p>\n          </div>\n        </div>\n\n        <div v-if=\"status.lastError\" class=\"bg-red-500/20 border border-red-500/50 rounded-lg p-4\">\n          <p class=\"text-red-400 font-medium\">Last Error</p>\n          <p class=\"text-red-300 text-sm mt-1\">{{ status.lastError }}</p>\n        </div>\n\n        <div class=\"flex gap-4\">\n          <button\n            @click=\"toggleBot\"\n            :disabled=\"toggling\"\n            :class=\"[\n              'px-6 py-3 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed',\n              status.running\n                ? 'bg-red-600 text-white hover:bg-red-700'\n                : 'bg-emerald-600 text-white hover:bg-emerald-700',\n            ]\"\n          >\n            {{ toggling ? 'Processing...' : status.running ? 'Stop Bot' : 'Start Bot' }}\n          </button>\n\n          <button\n            @click=\"triggerBot\"\n            :disabled=\"triggering\"\n            class=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {{ triggering ? 'Running...' : 'Trigger Now' }}\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\n\ninterface BotState {\n  running: boolean\n  lastRun?: number\n  lastError?: string\n}\n\nconst status = ref<BotState>({ running: false })\nconst loading = ref(true)\nconst toggling = ref(false)\nconst triggering = ref(false)\n\nconst fetchStatus = async () => {\n  try {\n    const data = await $fetch<BotState>('/api/bot/status')\n    status.value = data\n  } catch (err) {\n    console.error('Failed to fetch bot status:', err)\n  } finally {\n    loading.value = false\n  }\n}\n\nconst toggleBot = async () => {\n  toggling.value = true\n  try {\n    const endpoint = status.value.running ? '/api/bot/stop' : '/api/bot/start'\n    await $fetch(endpoint, { method: 'POST' })\n    await fetchStatus()\n  } catch (err) {\n    console.error('Failed to toggle bot:', err)\n    alert('Failed to toggle bot status')\n  } finally {\n    toggling.value = false\n  }\n}\n\nconst triggerBot = async () => {\n  triggering.value = true\n  try {\n    await $fetch('/api/bot/trigger', { method: 'POST' })\n    alert('Bot triggered successfully!')\n    await fetchStatus()\n  } catch (err: any) {\n    console.error('Failed to trigger bot:', err)\n    alert(err?.data?.message || err?.message || 'Failed to trigger bot')\n  } finally {\n    triggering.value = false\n  }\n}\n\nconst formatDate = (timestamp: number) => {\n  return new Date(timestamp).toLocaleString()\n}\n\nonMounted(() => {\n  fetchStatus()\n  setInterval(fetchStatus, 10000)\n})\n</script>\n","<template>\n  <div class=\"delegation-card\">\n    <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6\">\n      <h2 class=\"text-lg font-semibold mb-2\">EIP PetOperator Delegation</h2>\n      <p class=\"text-slate-400 text-sm mb-4\">\n        Keep your Aavegotchis in your wallet. Approve our petter to pet on your behalf—no transfer needed.\n      </p>\n\n      <div v-if=\"loading\" class=\"text-center py-4\">\n        <p class=\"text-slate-400\">Loading...</p>\n      </div>\n\n      <div v-else class=\"space-y-4\">\n        <div class=\"bg-white/5 rounded-lg p-4 font-mono text-sm break-all\">\n          <span class=\"text-slate-400\">Petter address: </span>\n          {{ petterAddress || '—' }}\n        </div>\n\n        <div class=\"space-y-2\">\n          <div class=\"flex items-center gap-2\">\n            <span\n              class=\"w-3 h-3 rounded-full\"\n              :class=\"status?.approved ? 'bg-emerald-500' : 'bg-amber-500'\"\n            />\n            <span>{{ status?.approved ? 'Approved' : 'Not approved' }}</span>\n          </div>\n          <div class=\"flex items-center gap-2\">\n            <span\n              class=\"w-3 h-3 rounded-full\"\n              :class=\"status?.registered ? 'bg-emerald-500' : 'bg-slate-500'\"\n            />\n            <span>{{ status?.registered ? 'Registered' : 'Not registered' }}</span>\n          </div>\n          <div v-if=\"status?.gotchiCount !== undefined\" class=\"text-sm text-slate-400\">\n            {{ status.gotchiCount }} Aavegotchi(es) in your wallet\n          </div>\n        </div>\n\n        <div class=\"flex flex-col gap-2\">\n          <button\n            v-if=\"!status?.approved\"\n            @click=\"approveDelegation\"\n            :disabled=\"approving\"\n            class=\"px-6 py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 font-medium\"\n          >\n            {{ approving ? 'Confirm in wallet...' : '1. Approve Petter (sign tx)' }}\n          </button>\n          <button\n            v-else-if=\"status?.canRegister\"\n            @click=\"register\"\n            :disabled=\"registering\"\n            class=\"px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 font-medium\"\n          >\n            {{ registering ? 'Registering...' : '2. Register for Auto-Petting' }}\n          </button>\n          <div\n            v-else-if=\"status?.registered\"\n            class=\"px-4 py-2 bg-emerald-500/20 text-emerald-400 rounded-lg text-sm border border-emerald-500/50\"\n          >\n            ✓ You're all set! Your Aavegotchis will be petted every 12 hours.\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\nimport { getWalletClient, writeContract } from '@wagmi/core'\nimport { wagmiConfig, AAVEGOTCHI_DIAMOND_ADDRESS, AAVEGOTCHI_FACET_ABI } from '~/lib/wagmi'\n\ninterface DelegationStatus {\n  approved: boolean\n  registered: boolean\n  gotchiCount: number\n  petterAddress: string\n  canRegister: boolean\n}\n\nconst status = ref<DelegationStatus | null>(null)\nconst petterAddress = ref('')\nconst loading = ref(true)\nconst approving = ref(false)\nconst registering = ref(false)\n\nconst fetchStatus = async () => {\n  try {\n    const statusRes = await $fetch<DelegationStatus>('/api/delegation/status')\n    status.value = statusRes\n    petterAddress.value = statusRes.petterAddress || ''\n  } catch (err) {\n    console.error('Failed to fetch delegation status:', err)\n  } finally {\n    loading.value = false\n  }\n}\n\nconst approveDelegation = async () => {\n  if (!petterAddress.value) {\n    alert('Petter address not configured')\n    return\n  }\n  approving.value = true\n  try {\n    const walletClient = await getWalletClient(wagmiConfig)\n    if (!walletClient) {\n      alert('Please connect your wallet first')\n      return\n    }\n    await writeContract(wagmiConfig, {\n      address: AAVEGOTCHI_DIAMOND_ADDRESS,\n      abi: AAVEGOTCHI_FACET_ABI,\n      functionName: 'setPetOperatorForAll',\n      args: [petterAddress.value as `0x${string}`, true],\n    })\n    await fetchStatus()\n  } catch (err: any) {\n    console.error('Approve failed:', err)\n    alert(err?.message || 'Approval failed')\n  } finally {\n    approving.value = false\n  }\n}\n\nconst register = async () => {\n  registering.value = true\n  try {\n    await $fetch('/api/delegation/register', { method: 'POST' })\n    await fetchStatus()\n  } catch (err: any) {\n    alert(err?.data?.message || err?.message || 'Registration failed')\n  } finally {\n    registering.value = false\n  }\n}\n\nonMounted(() => {\n  fetchStatus()\n})\n</script>\n","<template>\n  <div class=\"delegation-list\">\n    <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6\">\n      <div class=\"flex items-center justify-between mb-4\">\n        <h2 class=\"text-lg font-semibold\">Delegating Owners</h2>\n        <button\n          @click=\"fetchOwners\"\n          :disabled=\"loading\"\n          class=\"px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-lg text-sm transition disabled:opacity-50\"\n        >\n          {{ loading ? 'Loading...' : 'Refresh' }}\n        </button>\n      </div>\n\n      <div v-if=\"loading && owners.length === 0\" class=\"text-center py-8 text-slate-400\">\n        <p>Loading delegation list...</p>\n      </div>\n\n      <div v-else-if=\"owners.length === 0\" class=\"text-center py-8 text-slate-400\">\n        <p>No users have delegated petting yet</p>\n      </div>\n\n      <div v-else class=\"space-y-4\">\n        <div class=\"flex justify-between text-sm text-slate-400 mb-2\">\n          <span>Total: {{ owners.length }} owner(s)</span>\n          <span class=\"font-semibold text-white\">{{ totalGotchis }} Aavegotchis to pet</span>\n        </div>\n        <div class=\"space-y-2 max-h-64 overflow-y-auto\">\n          <div\n            v-for=\"item in owners\"\n            :key=\"item.address\"\n            class=\"flex items-center justify-between p-3 bg-white/5 rounded-lg hover:bg-white/10 transition\"\n          >\n            <a\n              :href=\"`https://basescan.org/address/${item.address}`\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              class=\"font-mono text-sm text-blue-400 hover:text-blue-300 truncate flex-1 min-w-0\"\n            >\n              {{ item.address.slice(0, 6) }}...{{ item.address.slice(-4) }}\n            </a>\n            <span class=\"text-emerald-400 font-medium ml-3 shrink-0\">\n              {{ item.gotchiCount }} gotchi{{ item.gotchiCount !== 1 ? 's' : '' }}\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\n\ninterface DelegationOwner {\n  address: string\n  gotchiCount: number\n}\n\nconst owners = ref<DelegationOwner[]>([])\nconst totalGotchis = ref(0)\nconst loading = ref(false)\n\nconst fetchOwners = async () => {\n  loading.value = true\n  try {\n    const data = await $fetch<{ owners: DelegationOwner[]; totalGotchis: number }>(\n      '/api/delegation/owners'\n    )\n    owners.value = data.owners || []\n    totalGotchis.value = data.totalGotchis || 0\n  } catch (err) {\n    console.error('Failed to fetch delegation owners:', err)\n    owners.value = []\n    totalGotchis.value = 0\n  } finally {\n    loading.value = false\n  }\n}\n\nonMounted(() => {\n  fetchOwners()\n  setInterval(fetchOwners, 60000)\n})\n</script>\n","<template>\n  <div class=\"home-dashboard min-h-screen bg-gradient-to-br from-slate-900 via-purple-900/20 to-slate-900 text-white p-4 md:p-8\">\n    <div class=\"max-w-6xl mx-auto space-y-6\">\n      <!-- Header -->\n      <div class=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n        <div>\n          <h1 class=\"text-3xl md:text-4xl font-bold tracking-tight\">Aavegotchi Petter</h1>\n          <p class=\"text-slate-400 mt-1\">Automated petting on Base • Every 12 hours</p>\n        </div>\n        <div class=\"flex items-center gap-3\">\n          <div\n            class=\"flex items-center gap-2 px-4 py-2 rounded-lg\"\n            :class=\"status.running ? 'bg-emerald-500/20 border border-emerald-500/50' : 'bg-amber-500/20 border border-amber-500/50'\"\n          >\n            <div class=\"w-2 h-2 rounded-full animate-pulse\" :class=\"status.running ? 'bg-emerald-400' : 'bg-amber-400'\" />\n            <span class=\"text-sm font-medium\">{{ status.running ? 'Running' : 'Stopped' }}</span>\n          </div>\n          <button\n            v-if=\"isAuthenticated\"\n            @click=\"logout\"\n            class=\"px-4 py-2 bg-red-600/80 hover:bg-red-600 rounded-lg text-sm font-medium transition\"\n          >\n            Logout\n          </button>\n          <WalletConnect v-else />\n        </div>\n      </div>\n\n      <!-- Stats Grid -->\n      <div class=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-4\">\n          <p class=\"text-slate-400 text-sm\">Next Pet</p>\n          <p class=\"text-xl font-bold mt-1 font-mono\">{{ nextPetTimer }}</p>\n        </div>\n        <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-4\">\n          <p class=\"text-slate-400 text-sm\">Total Petted</p>\n          <p class=\"text-xl font-bold mt-1\">{{ stats.totalAavegotchisPetted ?? 0 }}</p>\n        </div>\n        <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-4\">\n          <p class=\"text-slate-400 text-sm\">Success Rate</p>\n          <p class=\"text-xl font-bold mt-1\" :class=\"successRateColor\">{{ stats.successRate ?? 100 }}%</p>\n        </div>\n        <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-4\">\n          <p class=\"text-slate-400 text-sm\">Last 24h</p>\n          <p class=\"text-xl font-bold mt-1\">{{ stats.transactionsLast24h ?? 0 }}</p>\n        </div>\n      </div>\n\n      <!-- Wallet & Auth Section -->\n      <div v-if=\"isAuthenticated\" class=\"grid md:grid-cols-2 gap-6\">\n        <!-- Wallet Info -->\n        <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6\">\n          <h2 class=\"text-lg font-semibold mb-4\">Wallet</h2>\n          <div class=\"space-y-3\">\n            <div>\n              <p class=\"text-slate-400 text-sm\">Address</p>\n              <p class=\"font-mono text-sm break-all mt-1\">{{ walletAddress || '—' }}</p>\n            </div>\n            <div>\n              <p class=\"text-slate-400 text-sm\">Balance (ETH)</p>\n              <p class=\"font-mono text-lg font-bold mt-1\">{{ walletBalance ?? '—' }}</p>\n            </div>\n            <div>\n              <p class=\"text-slate-400 text-sm\">Gotchis Delegated</p>\n              <p class=\"font-mono text-lg font-bold mt-1\">{{ delegationStatus?.gotchiCount ?? '—' }}</p>\n            </div>\n          </div>\n        </div>\n\n        <!-- Last Run -->\n        <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6\">\n          <h2 class=\"text-lg font-semibold mb-4\">Bot Status</h2>\n          <div class=\"space-y-3\">\n            <div>\n              <p class=\"text-slate-400 text-sm\">Last Run</p>\n              <p class=\"mt-1\">{{ formatDate(status.lastRun) }}</p>\n            </div>\n            <div v-if=\"status.lastError\">\n              <p class=\"text-slate-400 text-sm\">Last Error</p>\n              <p class=\"text-red-400 text-sm mt-1 truncate\">{{ status.lastError }}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- History Log -->\n      <div class=\"bg-white/5 backdrop-blur border border-white/10 rounded-xl p-6\">\n        <div class=\"flex items-center justify-between mb-4\">\n          <h2 class=\"text-lg font-semibold\">Execution History</h2>\n          <button\n            v-if=\"isAuthenticated\"\n            @click=\"fetchHistory\"\n            :disabled=\"historyLoading\"\n            class=\"px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-lg text-sm transition disabled:opacity-50\"\n          >\n            Refresh\n          </button>\n        </div>\n        <div v-if=\"!isAuthenticated\" class=\"text-center py-12 text-slate-400\">\n          <p>Connect wallet to view execution history</p>\n        </div>\n        <div v-else-if=\"historyLoading\" class=\"text-center py-12 text-slate-400\">\n          <p>Loading...</p>\n        </div>\n        <div v-else-if=\"history.length === 0\" class=\"text-center py-12 text-slate-400\">\n          <p>No executions yet</p>\n        </div>\n        <div v-else class=\"space-y-3 max-h-64 overflow-y-auto\">\n          <div\n            v-for=\"tx in history\"\n            :key=\"tx.hash\"\n            class=\"flex items-center justify-between p-3 bg-white/5 rounded-lg hover:bg-white/10 transition\"\n          >\n            <div class=\"flex-1 min-w-0\">\n              <a\n                :href=\"`https://basescan.org/tx/${tx.hash}`\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                class=\"font-mono text-sm text-blue-400 hover:text-blue-300 truncate block\"\n              >\n                {{ tx.hash.slice(0, 10) }}...{{ tx.hash.slice(-8) }}\n              </a>\n              <p class=\"text-slate-400 text-xs mt-1\">{{ formatDate(tx.timestamp) }} • {{ tx.tokenIds.length }} petted</p>\n            </div>\n            <span class=\"text-emerald-400 text-xs font-medium ml-2\">Success</span>\n          </div>\n        </div>\n      </div>\n\n      <!-- Bot Control & Delegation -->\n      <div v-if=\"isAuthenticated\" class=\"grid md:grid-cols-2 gap-6 mt-6\">\n        <BotControl />\n        <DelegationCard />\n      </div>\n\n      <!-- Delegating Owners -->\n      <div v-if=\"isAuthenticated\" class=\"mt-6\">\n        <DelegationList />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted } from 'vue'\nimport { disconnect } from '@wagmi/core'\nimport { wagmiConfig } from '~/lib/wagmi'\nimport { formatEther } from 'viem'\nimport { createPublicClient, http } from 'viem'\nimport { base } from 'viem/chains'\n\ninterface HealthData {\n  status: string\n  bot: { running: boolean; lastRun: string | null; lastError: string | null }\n  stats: {\n    totalTransactions: number\n    totalAavegotchisPetted: number\n    transactionsLast24h: number\n    successRate: number\n  }\n}\n\ninterface Transaction {\n  hash: string\n  timestamp: number\n  blockNumber: number\n  gasUsed: string\n  tokenIds: string[]\n}\n\ninterface DelegationStatus {\n  approved: boolean\n  registered: boolean\n  gotchiCount: number\n}\n\nconst health = ref<HealthData | null>(null)\nconst history = ref<Transaction[]>([])\nconst delegationStatus = ref<DelegationStatus | null>(null)\nconst walletBalance = ref<string | null>(null)\nconst loading = ref(true)\nconst historyLoading = ref(false)\nconst isAuthenticated = ref(false)\n\nconst status = computed(() => ({\n  running: health.value?.bot?.running ?? false,\n  lastRun: health.value?.bot?.lastRun ?? null,\n  lastError: health.value?.bot?.lastError ?? null,\n}))\n\nconst stats = computed(() => health.value?.stats ?? { successRate: 100 })\n\nconst nextPetTimer = computed(() => {\n  const lastRun = health.value?.bot?.lastRun\n  if (!lastRun) return '—'\n  const lastRunMs = new Date(lastRun).getTime()\n  const nextRunMs = lastRunMs + 12 * 60 * 60 * 1000\n  const now = Date.now()\n  if (now >= nextRunMs) return 'Ready'\n  const diff = nextRunMs - now\n  const h = Math.floor(diff / 3600000)\n  const m = Math.floor((diff % 3600000) / 60000)\n  return `${h}h ${m}m`\n})\n\nconst walletAddress = ref<string | null>(null)\n\nconst successRateColor = computed(() => {\n  const rate = stats.value?.successRate ?? 100\n  if (rate >= 95) return 'text-emerald-400'\n  if (rate >= 80) return 'text-amber-400'\n  return 'text-red-400'\n})\n\nconst fetchHealth = async () => {\n  try {\n    const data = await $fetch<HealthData>('/api/health')\n    health.value = data\n  } catch (err) {\n    console.error('Failed to fetch health:', err)\n  }\n}\n\nconst fetchHistory = async () => {\n  if (!isAuthenticated.value) return\n  historyLoading.value = true\n  try {\n    const data = await $fetch<Transaction[]>('/api/transactions', { query: { limit: 20 } })\n    history.value = data\n  } catch (err) {\n    console.error('Failed to fetch history:', err)\n  } finally {\n    historyLoading.value = false\n  }\n}\n\nconst fetchDelegation = async () => {\n  try {\n    const data = await $fetch<DelegationStatus>('/api/delegation/status')\n    delegationStatus.value = data\n  } catch (err) {\n    delegationStatus.value = null\n  }\n}\n\nconst fetchMe = async () => {\n  try {\n    const res = await $fetch<{ address: string | null }>('/api/auth/me')\n    walletAddress.value = res.address\n  } catch {\n    walletAddress.value = null\n  }\n}\n\nconst fetchBalance = async () => {\n  const addr = walletAddress.value\n  if (!addr) return\n  try {\n    const client = createPublicClient({\n      chain: base,\n      transport: http(),\n    })\n    const balance = await client.getBalance({ address: addr as `0x${string}` })\n    walletBalance.value = parseFloat(formatEther(balance)).toFixed(4)\n  } catch (err) {\n    walletBalance.value = '—'\n  }\n}\n\nconst checkAuth = async () => {\n  try {\n    const res = await $fetch<{ authenticated: boolean }>('/api/auth/check')\n    isAuthenticated.value = res.authenticated\n  } catch {\n    isAuthenticated.value = false\n  }\n}\n\nconst logout = async () => {\n  try {\n    await $fetch('/api/auth/logout', { method: 'POST' })\n    await disconnect(wagmiConfig)\n    await navigateTo('/')\n  } catch (err) {\n    console.error('Failed to logout:', err)\n  }\n}\n\nconst formatDate = (val: string | number | undefined) => {\n  if (!val) return '—'\n  const ts = typeof val === 'string' ? new Date(val).getTime() : val\n  return new Date(ts).toLocaleString()\n}\n\nonMounted(async () => {\n  await checkAuth()\n  await fetchHealth()\n  if (isAuthenticated.value) {\n    await fetchMe()\n    await Promise.all([fetchHistory(), fetchDelegation(), fetchBalance()])\n  }\n  loading.value = false\n  setInterval(fetchHealth, 30000)\n  if (isAuthenticated.value) {\n    setInterval(() => Promise.all([fetchMe(), fetchHistory(), fetchBalance()]), 60000)\n  }\n})\n</script>\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderClass","_ssrInterpolate","_ssrRenderList"],"mappings":"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"}