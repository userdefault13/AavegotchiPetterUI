import{createRequire}from"module";const require=createRequire(import.meta.url);
var Ou=Object.create;var Vr=Object.defineProperty;var Nu=Object.getOwnPropertyDescriptor;var vu=Object.getOwnPropertyNames;var Pu=Object.getPrototypeOf,gu=Object.prototype.hasOwnProperty;var Ia=e=>{throw TypeError(e)};var Lo=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var p=(e,t)=>()=>(e&&(t=e(e=0)),t);var m=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Je=(e,t)=>{for(var r in t)Vr(e,r,{get:t[r],enumerable:!0})},Ma=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of vu(t))!gu.call(e,o)&&o!==r&&Vr(e,o,{get:()=>t[o],enumerable:!(n=Nu(t,o))||n.enumerable});return e};var xa=(e,t,r)=>(r=e!=null?Ou(Pu(e)):{},Ma(t||!e||!e.__esModule?Vr(r,"default",{value:e,enumerable:!0}):r,e)),Tt=e=>Ma(Vr({},"__esModule",{value:!0}),e);var Co=(e,t,r)=>t.has(e)||Ia("Cannot "+r);var u=(e,t,r)=>(Co(e,t,"read from private field"),r?r.call(e):t.get(e)),w=(e,t,r)=>t.has(e)?Ia("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),b=(e,t,r,n)=>(Co(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),A=(e,t,r)=>(Co(e,t,"access private method"),r);var Da,Ua=p(()=>{Da=typeof globalThis=="object"?globalThis:global});var ya=p(()=>{Ua()});var ba=p(()=>{ya()});var Ve,Io=p(()=>{Ve="1.9.0"});function Lu(e){var t=new Set([e]),r=new Set,n=e.match(Va);if(!n)return function(){return!1};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(E){return E===e};function s(i){return r.add(i),!1}function a(i){return t.add(i),!0}return function(E){if(t.has(E))return!0;if(r.has(E))return!1;var _=E.match(Va);if(!_)return s(E);var c={major:+_[1],minor:+_[2],patch:+_[3],prerelease:_[4]};return c.prerelease!=null||o.major!==c.major?s(E):o.major===0?o.minor===c.minor&&o.patch<=c.patch?a(E):s(E):o.minor<=c.minor?a(E):s(E)}}var Va,wa,Ga=p(()=>{Io();Va=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;wa=Lu(Ve)});function Pe(e,t,r,n){var o;n===void 0&&(n=!1);var s=Xt[Kt]=(o=Xt[Kt])!==null&&o!==void 0?o:{version:Ve};if(!n&&s[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(a.stack||a.message),!1}if(s.version!==Ve){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+e+" does not match previously registered API v"+Ve);return r.error(a.stack||a.message),!1}return s[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+Ve+"."),!0}function ie(e){var t,r,n=(t=Xt[Kt])===null||t===void 0?void 0:t.version;if(!(!n||!wa(n)))return(r=Xt[Kt])===null||r===void 0?void 0:r[e]}function ge(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Ve+".");var r=Xt[Kt];r&&delete r[e]}var Cu,Kt,Xt,Qe=p(()=>{ba();Io();Ga();Cu=Ve.split(".")[0],Kt=Symbol.for("opentelemetry.js.api."+Cu),Xt=Da});function Wt(e,t,r){var n=ie("diag");if(n)return r.unshift(t),n[e].apply(n,Mu([],Iu(r),!1))}var Iu,Mu,Ba,Ha=p(()=>{Qe();Iu=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(i){a={error:i}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Mu=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Ba=(function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Wt("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Wt("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Wt("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Wt("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Wt("verbose",this._namespace,t)},e})()});var I,wr=p(()=>{(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(I||(I={}))});function Fa(e,t){e<I.NONE?e=I.NONE:e>I.ALL&&(e=I.ALL),t=t||{};function r(n,o){var s=t[n];return typeof s=="function"&&e>=o?s.bind(t):function(){}}return{error:r("error",I.ERROR),warn:r("warn",I.WARN),info:r("info",I.INFO),debug:r("debug",I.DEBUG),verbose:r("verbose",I.VERBOSE)}}var Ya=p(()=>{wr()});var xu,Du,Uu,j,Ze=p(()=>{Ha();Ya();wr();Qe();xu=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(i){a={error:i}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Du=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Uu="diag",j=(function(){function e(){function t(o){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var i=ie("diag");if(i)return i[o].apply(i,Du([],xu(s),!1))}}var r=this,n=function(o,s){var a,i,E;if(s===void 0&&(s={logLevel:I.INFO}),o===r){var _=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((a=_.stack)!==null&&a!==void 0?a:_.message),!1}typeof s=="number"&&(s={logLevel:s});var c=ie("diag"),T=Fa((i=s.logLevel)!==null&&i!==void 0?i:I.INFO,o);if(c&&!s.suppressOverrideMessage){var l=(E=new Error().stack)!==null&&E!==void 0?E:"<failed to generate stacktrace>";c.warn("Current logger will be overwritten from "+l),T.warn("Current logger will overwrite one already registered from "+l)}return Pe("diag",T,r,!0)};r.setLogger=n,r.disable=function(){ge(Uu,r)},r.createComponentLogger=function(o){return new Ba(o)},r.verbose=t("verbose"),r.debug=t("debug"),r.info=t("info"),r.warn=t("warn"),r.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e})()});var yu,bu,$a,ka=p(()=>{yu=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(i){a={error:i}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},bu=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$a=(function(){function e(t){this._entries=t?new Map(t):new Map}return e.prototype.getEntry=function(t){var r=this._entries.get(t);if(r)return Object.assign({},r)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(t){var r=yu(t,2),n=r[0],o=r[1];return[n,o]})},e.prototype.setEntry=function(t,r){var n=new e(this._entries);return n._entries.set(t,r),n},e.prototype.removeEntry=function(t){var r=new e(this._entries);return r._entries.delete(t),r},e.prototype.removeEntries=function(){for(var t,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=new e(this._entries);try{for(var a=bu(n),i=a.next();!i.done;i=a.next()){var E=i.value;s._entries.delete(E)}}catch(_){t={error:_}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return s},e.prototype.clear=function(){return new e},e})()});var qa,ja=p(()=>{qa=Symbol("BaggageEntryMetadata")});function Ka(e){return e===void 0&&(e={}),new $a(new Map(Object.entries(e)))}function Gr(e){return typeof e!="string"&&(Vu.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:qa,toString:function(){return e}}}var Vu,Mo=p(()=>{Ze();ka();ja();Vu=j.instance()});function Le(e){return Symbol.for(e)}var wu,Br,zt=p(()=>{wu=(function(){function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var s=new e(r._currentContext);return s._currentContext.set(n,o),s},r.deleteValue=function(n){var o=new e(r._currentContext);return o._currentContext.delete(n),o}}return e})(),Br=new wu});var xo,Xa,Wa=p(()=>{xo=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],Xa=(function(){function e(){function t(n){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];if(console){var a=console[n];if(typeof a!="function"&&(a=console.log),typeof a=="function")return a.apply(console,o)}}}for(var r=0;r<xo.length;r++)this[xo[r].n]=t(xo[r].c)}return e})()});function za(){return Uo}var et,Gu,Hr,Bu,Hu,Fu,Yu,Do,$u,ku,qu,Uo,ju,Ku,Xu,Wu,zu,Ju,Qu,yo=p(()=>{et=(function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}})(),Gu=(function(){function e(){}return e.prototype.createGauge=function(t,r){return Ku},e.prototype.createHistogram=function(t,r){return Xu},e.prototype.createCounter=function(t,r){return ju},e.prototype.createUpDownCounter=function(t,r){return Wu},e.prototype.createObservableGauge=function(t,r){return Ju},e.prototype.createObservableCounter=function(t,r){return zu},e.prototype.createObservableUpDownCounter=function(t,r){return Qu},e.prototype.addBatchObservableCallback=function(t,r){},e.prototype.removeBatchObservableCallback=function(t){},e})(),Hr=(function(){function e(){}return e})(),Bu=(function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.add=function(r,n){},t})(Hr),Hu=(function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.add=function(r,n){},t})(Hr),Fu=(function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.record=function(r,n){},t})(Hr),Yu=(function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.record=function(r,n){},t})(Hr),Do=(function(){function e(){}return e.prototype.addCallback=function(t){},e.prototype.removeCallback=function(t){},e})(),$u=(function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(Do),ku=(function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(Do),qu=(function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(Do),Uo=new Gu,ju=new Bu,Ku=new Fu,Xu=new Yu,Wu=new Hu,zu=new $u,Ju=new ku,Qu=new qu});var Fr,Ja=p(()=>{(function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"})(Fr||(Fr={}))});var Yr,$r,bo=p(()=>{Yr={get:function(e,t){if(e!=null)return e[t]},keys:function(e){return e==null?[]:Object.keys(e)}},$r={set:function(e,t,r){e!=null&&(e[t]=r)}}});var Zu,eS,Qa,Za=p(()=>{zt();Zu=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(i){a={error:i}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},eS=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Qa=(function(){function e(){}return e.prototype.active=function(){return Br},e.prototype.with=function(t,r,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.call.apply(r,eS([n],Zu(o),!1))},e.prototype.bind=function(t,r){return r},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e})()});var tS,rS,Vo,nS,Ye,Jt=p(()=>{Za();Qe();Ze();tS=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(i){a={error:i}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},rS=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Vo="context",nS=new Qa,Ye=(function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return Pe(Vo,t,j.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,r,n){for(var o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return(o=this._getContextManager()).with.apply(o,rS([t,r,n],tS(s),!1))},e.prototype.bind=function(t,r){return this._getContextManager().bind(t,r)},e.prototype._getContextManager=function(){return ie(Vo)||nS},e.prototype.disable=function(){this._getContextManager().disable(),ge(Vo,j.instance())},e})()});var L,wo=p(()=>{(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(L||(L={}))});var Qt,Zt,ut,kr=p(()=>{wo();Qt="0000000000000000",Zt="00000000000000000000000000000000",ut={traceId:Zt,spanId:Qt,traceFlags:L.NONE}});var $e,qr=p(()=>{kr();$e=(function(){function e(t){t===void 0&&(t=ut),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,r){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,r){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,r){},e})()});function jr(e){return e.getValue(Go)||void 0}function ei(){return jr(Ye.getInstance().active())}function er(e,t){return e.setValue(Go,t)}function ti(e){return e.deleteValue(Go)}function ri(e,t){return er(e,new $e(t))}function Kr(e){var t;return(t=jr(e))===null||t===void 0?void 0:t.spanContext()}var Go,Bo=p(()=>{zt();qr();Jt();Go=Le("OpenTelemetry Context Key SPAN")});function we(e){return oS.test(e)&&e!==Zt}function tt(e){return sS.test(e)&&e!==Qt}function ne(e){return we(e.traceId)&&tt(e.spanId)}function ni(e){return new $e(e)}var oS,sS,Xr=p(()=>{kr();qr();oS=/^([0-9a-f]{32})$/i,sS=/^[0-9a-f]{16}$/i});function aS(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var Ho,Wr,Fo=p(()=>{Jt();Bo();qr();Xr();Ho=Ye.getInstance(),Wr=(function(){function e(){}return e.prototype.startSpan=function(t,r,n){n===void 0&&(n=Ho.active());var o=!!(r!=null&&r.root);if(o)return new $e;var s=n&&Kr(n);return aS(s)&&ne(s)?new $e(s):new $e},e.prototype.startActiveSpan=function(t,r,n,o){var s,a,i;if(!(arguments.length<2)){arguments.length===2?i=r:arguments.length===3?(s=r,i=n):(s=r,a=n,i=o);var E=a??Ho.active(),_=this.startSpan(t,s,E),c=er(E,_);return Ho.with(c,i,void 0,_)}},e})()});var iS,zr,Yo=p(()=>{Fo();iS=new Wr,zr=(function(){function e(t,r,n,o){this._provider=t,this.name=r,this.version=n,this.options=o}return e.prototype.startSpan=function(t,r,n){return this._getTracer().startSpan(t,r,n)},e.prototype.startActiveSpan=function(t,r,n,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):iS},e})()});var oi,si=p(()=>{Fo();oi=(function(){function e(){}return e.prototype.getTracer=function(t,r,n){return new Wr},e})()});var ES,tr,$o=p(()=>{Yo();si();ES=new oi,tr=(function(){function e(){}return e.prototype.getTracer=function(t,r,n){var o;return(o=this.getDelegateTracer(t,r,n))!==null&&o!==void 0?o:new zr(this,t,r,n)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:ES},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getTracer(t,r,n)},e})()});var rt,ai=p(()=>{(function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(rt||(rt={}))});var oe,ii=p(()=>{(function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"})(oe||(oe={}))});var F,Ei=p(()=>{(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(F||(F={}))});function _i(e){return pS.test(e)}function ci(e){return TS.test(e)&&!uS.test(e)}var ko,_S,cS,pS,TS,uS,pi=p(()=>{ko="[_0-9a-z-*/]",_S="[a-z]"+ko+"{0,255}",cS="[a-z0-9]"+ko+"{0,240}@[a-z]"+ko+"{0,13}",pS=new RegExp("^(?:"+_S+"|"+cS+")$"),TS=/^[ -~]{0,255}[!-~]$/,uS=/,|=/});var Ti,SS,ui,Si,li,Ai=p(()=>{pi();Ti=32,SS=512,ui=",",Si="=",li=(function(){function e(t){this._internalState=new Map,t&&this._parse(t)}return e.prototype.set=function(t,r){var n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,r),n},e.prototype.unset=function(t){var r=this._clone();return r._internalState.delete(t),r},e.prototype.get=function(t){return this._internalState.get(t)},e.prototype.serialize=function(){var t=this;return this._keys().reduce(function(r,n){return r.push(n+Si+t.get(n)),r},[]).join(ui)},e.prototype._parse=function(t){t.length>SS||(this._internalState=t.split(ui).reverse().reduce(function(r,n){var o=n.trim(),s=o.indexOf(Si);if(s!==-1){var a=o.slice(0,s),i=o.slice(s+1,n.length);_i(a)&&ci(i)&&r.set(a,i)}return r},new Map),this._internalState.size>Ti&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,Ti))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e})()});function fi(e){return new li(e)}var di=p(()=>{Ai()});var y,Ri=p(()=>{Jt();y=Ye.getInstance()});var O,hi=p(()=>{Ze();O=j.instance()});var lS,mi,Oi=p(()=>{yo();lS=(function(){function e(){}return e.prototype.getMeter=function(t,r,n){return Uo},e})(),mi=new lS});var qo,Ni,vi=p(()=>{Oi();Qe();Ze();qo="metrics",Ni=(function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(t){return Pe(qo,t,j.instance())},e.prototype.getMeterProvider=function(){return ie(qo)||mi},e.prototype.getMeter=function(t,r,n){return this.getMeterProvider().getMeter(t,r,n)},e.prototype.disable=function(){ge(qo,j.instance())},e})()});var rr,Pi=p(()=>{vi();rr=Ni.getInstance()});var gi,Li=p(()=>{gi=(function(){function e(){}return e.prototype.inject=function(t,r){},e.prototype.extract=function(t,r){return t},e.prototype.fields=function(){return[]},e})()});function Ko(e){return e.getValue(jo)||void 0}function Ci(){return Ko(Ye.getInstance().active())}function Ii(e,t){return e.setValue(jo,t)}function Mi(e){return e.deleteValue(jo)}var jo,xi=p(()=>{Jt();zt();jo=Le("OpenTelemetry Baggage Key")});var Xo,AS,Di,Ui=p(()=>{Qe();Li();bo();xi();Mo();Ze();Xo="propagation",AS=new gi,Di=(function(){function e(){this.createBaggage=Ka,this.getBaggage=Ko,this.getActiveBaggage=Ci,this.setBaggage=Ii,this.deleteBaggage=Mi}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(t){return Pe(Xo,t,j.instance())},e.prototype.inject=function(t,r,n){return n===void 0&&(n=$r),this._getGlobalPropagator().inject(t,r,n)},e.prototype.extract=function(t,r,n){return n===void 0&&(n=Yr),this._getGlobalPropagator().extract(t,r,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){ge(Xo,j.instance())},e.prototype._getGlobalPropagator=function(){return ie(Xo)||AS},e})()});var K,yi=p(()=>{Ui();K=Di.getInstance()});var Wo,bi,Vi=p(()=>{Qe();$o();Xr();Bo();Ze();Wo="trace",bi=(function(){function e(){this._proxyTracerProvider=new tr,this.wrapSpanContext=ni,this.isSpanContextValid=ne,this.deleteSpan=ti,this.getSpan=jr,this.getActiveSpan=ei,this.getSpanContext=Kr,this.setSpan=er,this.setSpanContext=ri}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var r=Pe(Wo,this._proxyTracerProvider,j.instance());return r&&this._proxyTracerProvider.setDelegate(t),r},e.prototype.getTracerProvider=function(){return ie(Wo)||this._proxyTracerProvider},e.prototype.getTracer=function(t,r){return this.getTracerProvider().getTracer(t,r)},e.prototype.disable=function(){ge(Wo,j.instance()),this._proxyTracerProvider=new tr},e})()});var P,wi=p(()=>{Vi();P=bi.getInstance()});var St={};Je(St,{DiagConsoleLogger:()=>Xa,DiagLogLevel:()=>I,INVALID_SPANID:()=>Qt,INVALID_SPAN_CONTEXT:()=>ut,INVALID_TRACEID:()=>Zt,ProxyTracer:()=>zr,ProxyTracerProvider:()=>tr,ROOT_CONTEXT:()=>Br,SamplingDecision:()=>rt,SpanKind:()=>oe,SpanStatusCode:()=>F,TraceFlags:()=>L,ValueType:()=>Fr,baggageEntryMetadataFromString:()=>Gr,context:()=>y,createContextKey:()=>Le,createNoopMeter:()=>za,createTraceState:()=>fi,default:()=>fS,defaultTextMapGetter:()=>Yr,defaultTextMapSetter:()=>$r,diag:()=>O,isSpanContextValid:()=>ne,isValidSpanId:()=>tt,isValidTraceId:()=>we,metrics:()=>rr,propagation:()=>K,trace:()=>P});var fS,g=p(()=>{Mo();zt();Wa();wr();yo();Ja();bo();Yo();$o();ai();ii();Ei();wo();di();Xr();kr();Ri();hi();Pi();yi();wi();fS={context:y,diag:O,metrics:rr,propagation:K,trace:P}});function Gi(e,t,r){var n,o,s;return!t&&!r?s=e:r?(n=e,o=t,s=r):(n=e,s=t),n=n??{},o=o??y.active(),{opts:n,ctx:o,fn:s}}function Bi(e,t,r){var n,o=(n=t.onException)!==null&&n!==void 0?n:dS,s=function(i){throw o(i,e),e.end(),i};try{var a=r(e);return typeof(a==null?void 0:a.then)=="function"?a.then(function(i){return e.end(),i},s):(e.end(),a)}catch(i){throw s(i)}}var dS,Ce,Hi=p(()=>{g();dS=function(e,t){t.recordException(e),t.setStatus({code:F.ERROR})},Ce=(function(){function e(t){this._tracer=t,this.startSpan=t.startSpan.bind(this._tracer),this.startActiveSpan=t.startActiveSpan.bind(this._tracer)}return e.prototype.withActiveSpan=function(t,r,n,o){var s=Gi(r,n,o),a=s.opts,i=s.ctx,E=s.fn;return this._tracer.startActiveSpan(t,a,i,function(_){return Bi(_,a,E)})},e.prototype.withSpan=function(t,r,n,o){var s=Gi(r,n,o),a=s.opts,i=s.ctx,E=s.fn,_=this._tracer.startSpan(t,a,i);return Bi(_,a,E)},e})()});var Jr=p(()=>{Hi()});var RS,hS,mS,Qr,Zr,Fi,Yi=p(()=>{RS="exception.type",hS="exception.message",mS="exception.stacktrace",Qr=RS,Zr=hS,Fi=mS});var $i=p(()=>{Yi()});var OS,NS,vS,PS,gS,ki,qi,nr,or,sr,LS,ji,Ki=p(()=>{OS="process.runtime.name",NS="service.name",vS="telemetry.sdk.name",PS="telemetry.sdk.language",gS="telemetry.sdk.version",ki=OS,qi=NS,nr=vS,or=PS,sr=gS,LS="nodejs",ji=LS});var Xi=p(()=>{Ki()});var Wi=p(()=>{});var zi=p(()=>{});var en=p(()=>{$i();Xi();Wi();zi()});function ar(e){return e.setValue(Ji,!0)}function z(e){return e.getValue(Ji)===!0}var Ji,ir=p(()=>{g();Ji=Le("OpenTelemetry SDK Context Key SUPPRESS_TRACING")});var tn,Qi=p(()=>{tn="baggage"});function eE(e){return e.reduce((t,r)=>{let n=`${t}${t!==""?",":""}${r}`;return n.length>8192?t:n},"")}function tE(e){return e.getAllEntries().map(([t,r])=>{let n=`${encodeURIComponent(t)}=${encodeURIComponent(r.value)}`;return r.metadata!==void 0&&(n+=";"+r.metadata.toString()),n})}function rE(e){let t=e.split(";");if(t.length<=0)return;let r=t.shift();if(!r)return;let n=r.indexOf("=");if(n<=0)return;let o=decodeURIComponent(r.substring(0,n).trim()),s=decodeURIComponent(r.substring(n+1).trim()),a;return t.length>0&&(a=Gr(t.join(";"))),{key:o,value:s,metadata:a}}var nE=p(()=>{g()});var Er,oE=p(()=>{g();ir();Qi();nE();Er=class{inject(t,r,n){let o=K.getBaggage(t);if(!o||z(t))return;let s=tE(o).filter(i=>i.length<=4096).slice(0,180),a=eE(s);a.length>0&&n.set(r,tn,a)}extract(t,r,n){let o=n.get(r,tn),s=Array.isArray(o)?o.join(","):o;if(!s)return t;let a={};return s.length===0||(s.split(",").forEach(E=>{let _=rE(E);if(_){let c={value:_.value};_.metadata&&(c.metadata=_.metadata),a[_.key]=c}}),Object.entries(a).length===0)?t:K.setBaggage(t,K.createBaggage(a))}fields(){return[tn]}}});function nt(e){let t={};if(typeof e!="object"||e==null)return t;for(let[r,n]of Object.entries(e)){if(!sE(r)){O.warn(`Invalid attribute key: ${r}`);continue}if(!rn(n)){O.warn(`Invalid attribute value set for key: ${r}`);continue}Array.isArray(n)?t[r]=n.slice():t[r]=n}return t}function sE(e){return typeof e=="string"&&e.length>0}function rn(e){return e==null?!0:Array.isArray(e)?MS(e):aE(e)}function MS(e){let t;for(let r of e)if(r!=null){if(!t){if(aE(r)){t=typeof r;continue}return!1}if(typeof r!==t)return!1}return!0}function aE(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}var iE=p(()=>{g()});function EE(){return e=>{O.error(xS(e))}}function xS(e){return typeof e=="string"?e:JSON.stringify(DS(e))}function DS(e){let t={},r=e;for(;r!==null;)Object.getOwnPropertyNames(r).forEach(n=>{if(t[n])return;let o=r[n];o&&(t[n]=String(o))}),r=Object.getPrototypeOf(r);return t}var _E=p(()=>{g()});function Te(e){try{US(e)}catch{}}var US,cE=p(()=>{_E();US=EE()});var Ee,Jo=p(()=>{(function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"})(Ee||(Ee={}))});function VS(e){return bS.indexOf(e)>-1}function GS(e){return wS.indexOf(e)>-1}function HS(e){return BS.indexOf(e)>-1}function FS(e,t,r){if(typeof r[e]>"u")return;let n=String(r[e]);t[e]=n.toLowerCase()==="true"}function YS(e,t,r,n=-1/0,o=1/0){if(typeof r[e]<"u"){let s=Number(r[e]);isNaN(s)||(s<n?t[e]=n:s>o?t[e]=o:t[e]=s)}}function $S(e,t,r,n=yS){let o=r[e];typeof o=="string"&&(t[e]=o.split(n).map(s=>s.trim()))}function qS(e,t,r){let n=r[e];if(typeof n=="string"){let o=kS[n.toUpperCase()];o!=null&&(t[e]=o)}}function on(e){let t={};for(let r in nn){let n=r;switch(n){case"OTEL_LOG_LEVEL":qS(n,t,e);break;default:if(VS(n))FS(n,t,e);else if(GS(n))YS(n,t,e);else if(HS(n))$S(n,t,e);else{let o=e[n];typeof o<"u"&&o!==null&&(t[n]=String(o))}}}return t}var yS,bS,wS,BS,lt,At,pE,TE,nn,kS,Qo=p(()=>{g();Jo();yS=",",bS=["OTEL_SDK_DISABLED"];wS=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];BS=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS","OTEL_SEMCONV_STABILITY_OPT_IN"];lt=1/0,At=128,pE=128,TE=128,nn={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:I.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:lt,OTEL_ATTRIBUTE_COUNT_LIMIT:At,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:lt,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:At,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:lt,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:At,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:pE,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:TE,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:Ee.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative",OTEL_SEMCONV_STABILITY_OPT_IN:[]};kS={ALL:I.ALL,VERBOSE:I.VERBOSE,DEBUG:I.DEBUG,INFO:I.INFO,WARN:I.WARN,ERROR:I.ERROR,NONE:I.NONE}});function he(){let e=on(process.env);return Object.assign({},nn,e)}function _r(){return on(process.env)}var uE=p(()=>{Qo()});import{performance as jS}from"perf_hooks";var me,SE=p(()=>{me=jS});var lE,AE=p(()=>{lE="1.30.1"});var ot,fE=p(()=>{AE();en();ot={[nr]:"opentelemetry",[ki]:"node",[or]:ji,[sr]:lE}});function cr(e){e.unref()}var dE=p(()=>{});var RE=p(()=>{uE();SE();fE();dE()});var Zo=p(()=>{RE()});function ke(e){let t=e/1e3,r=Math.trunc(t),n=Math.round(e%1e3*QS);return[r,n]}function sn(){let e=me.timeOrigin;if(typeof e!="number"){let t=me;e=t.timing&&t.timing.fetchStart}return e}function ts(e){let t=ke(sn()),r=ke(typeof e=="number"?e:me.now());return cn(t,r)}function rs(e,t){let r=t[0]-e[0],n=t[1]-e[1];return n<0&&(r-=1,n+=es),[r,n]}function an(e){return e[0]*1e6+e[1]/1e3}function En(e){return Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"}function _n(e){return En(e)||typeof e=="number"||e instanceof Date}function cn(e,t){let r=[e[0]+t[0],e[1]+t[1]];return r[1]>=es&&(r[1]-=es,r[0]+=1),r}var zS,JS,QS,es,hE=p(()=>{Zo();zS=9,JS=6,QS=Math.pow(10,JS),es=Math.pow(10,zS)});var J,mE=p(()=>{(function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"})(J||(J={}))});var pr,OE=p(()=>{g();pr=class{constructor(t={}){var r;this._propagators=(r=t.propagators)!==null&&r!==void 0?r:[],this._fields=Array.from(new Set(this._propagators.map(n=>typeof n.fields=="function"?n.fields():[]).reduce((n,o)=>n.concat(o),[])))}inject(t,r,n){for(let o of this._propagators)try{o.inject(t,r,n)}catch(s){O.warn(`Failed to inject with ${o.constructor.name}. Err: ${s.message}`)}}extract(t,r,n){return this._propagators.reduce((o,s)=>{try{return s.extract(o,r,n)}catch(a){O.warn(`Failed to extract with ${s.constructor.name}. Err: ${a.message}`)}return o},t)}fields(){return this._fields.slice()}}});function NE(e){return tl.test(e)}function vE(e){return rl.test(e)&&!nl.test(e)}var ns,ZS,el,tl,rl,nl,PE=p(()=>{ns="[_0-9a-z-*/]",ZS=`[a-z]${ns}{0,255}`,el=`[a-z0-9]${ns}{0,240}@[a-z]${ns}{0,13}`,tl=new RegExp(`^(?:${ZS}|${el})$`),rl=/^[ -~]{0,255}[!-~]$/,nl=/,|=/});var gE,ol,LE,CE,pn,IE=p(()=>{PE();gE=32,ol=512,LE=",",CE="=",pn=class e{constructor(t){this._internalState=new Map,t&&this._parse(t)}set(t,r){let n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,r),n}unset(t){let r=this._clone();return r._internalState.delete(t),r}get(t){return this._internalState.get(t)}serialize(){return this._keys().reduce((t,r)=>(t.push(r+CE+this.get(r)),t),[]).join(LE)}_parse(t){t.length>ol||(this._internalState=t.split(LE).reverse().reduce((r,n)=>{let o=n.trim(),s=o.indexOf(CE);if(s!==-1){let a=o.slice(0,s),i=o.slice(s+1,n.length);NE(a)&&vE(i)&&r.set(a,i)}return r},new Map),this._internalState.size>gE&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,gE))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let t=new e;return t._internalState=new Map(this._internalState),t}}});function ME(e){let t=cl.exec(e);return!t||t[1]==="00"&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}}var Tn,un,sl,al,il,El,_l,cl,Ge,xE=p(()=>{g();ir();IE();Tn="traceparent",un="tracestate",sl="00",al="(?!ff)[\\da-f]{2}",il="(?![0]{32})[\\da-f]{32}",El="(?![0]{16})[\\da-f]{16}",_l="[\\da-f]{2}",cl=new RegExp(`^\\s?(${al})-(${il})-(${El})-(${_l})(-.*)?\\s?$`);Ge=class{inject(t,r,n){let o=P.getSpanContext(t);if(!o||z(t)||!ne(o))return;let s=`${sl}-${o.traceId}-${o.spanId}-0${Number(o.traceFlags||L.NONE).toString(16)}`;n.set(r,Tn,s),o.traceState&&n.set(r,un,o.traceState.serialize())}extract(t,r,n){let o=n.get(r,Tn);if(!o)return t;let s=Array.isArray(o)?o[0]:o;if(typeof s!="string")return t;let a=ME(s);if(!a)return t;a.isRemote=!0;let i=n.get(r,un);if(i){let E=Array.isArray(i)?i.join(","):i;a.traceState=new pn(typeof E=="string"?E:void 0)}return P.setSpanContext(t,a)}fields(){return[Tn,un]}}});function fl(e,t){return function(r){return e(t(r))}}function os(e){if(!dl(e)||Rl(e)!==pl)return!1;let t=Al(e);if(t===null)return!0;let r=yE.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&DE.call(r)===ll}function dl(e){return e!=null&&typeof e=="object"}function Rl(e){return e==null?e===void 0?ul:Tl:st&&st in Object(e)?hl(e):ml(e)}function hl(e){let t=yE.call(e,st),r=e[st],n=!1;try{e[st]=void 0,n=!0}catch{}let o=bE.call(e);return n&&(t?e[st]=r:delete e[st]),o}function ml(e){return bE.call(e)}var pl,Tl,ul,Sl,DE,ll,Al,UE,yE,st,bE,VE=p(()=>{pl="[object Object]",Tl="[object Null]",ul="[object Undefined]",Sl=Function.prototype,DE=Sl.toString,ll=DE.call(Object),Al=fl(Object.getPrototypeOf,Object),UE=Object.prototype,yE=UE.hasOwnProperty,st=Symbol?Symbol.toStringTag:void 0,bE=UE.toString});function as(...e){let t=e.shift(),r=new WeakMap;for(;e.length>0;)t=GE(t,e.shift(),0,r);return t}function ss(e){return ln(e)?e.slice():e}function GE(e,t,r=0,n){let o;if(!(r>Ol)){if(r++,Sn(e)||Sn(t)||BE(t))o=ss(t);else if(ln(e)){if(o=e.slice(),ln(t))for(let s=0,a=t.length;s<a;s++)o.push(ss(t[s]));else if(Tr(t)){let s=Object.keys(t);for(let a=0,i=s.length;a<i;a++){let E=s[a];o[E]=ss(t[E])}}}else if(Tr(e))if(Tr(t)){if(!Nl(e,t))return t;o=Object.assign({},e);let s=Object.keys(t);for(let a=0,i=s.length;a<i;a++){let E=s[a],_=t[E];if(Sn(_))typeof _>"u"?delete o[E]:o[E]=_;else{let c=o[E],T=_;if(wE(e,E,n)||wE(t,E,n))delete o[E];else{if(Tr(c)&&Tr(T)){let l=n.get(c)||[],f=n.get(T)||[];l.push({obj:e,key:E}),f.push({obj:t,key:E}),n.set(c,l),n.set(T,f)}o[E]=GE(o[E],_,r,n)}}}}else o=t;return o}}function wE(e,t,r){let n=r.get(e[t])||[];for(let o=0,s=n.length;o<s;o++){let a=n[o];if(a.key===t&&a.obj===e)return!0}return!1}function ln(e){return Array.isArray(e)}function BE(e){return typeof e=="function"}function Tr(e){return!Sn(e)&&!ln(e)&&!BE(e)&&typeof e=="object"}function Sn(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e>"u"||e instanceof Date||e instanceof RegExp||e===null}function Nl(e,t){return!(!os(e)||!os(t))}var Ol,HE=p(()=>{VE();Ol=20});var An,FE=p(()=>{An=class{constructor(){this._promise=new Promise((t,r)=>{this._resolve=t,this._reject=r})}get promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}}});var Be,YE=p(()=>{FE();Be=class{constructor(t,r){this._callback=t,this._that=r,this._isCalled=!1,this._deferred=new An}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...t){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...t)).then(r=>this._deferred.resolve(r),r=>this._deferred.reject(r))}catch(r){this._deferred.reject(r)}}return this._deferred.promise}}});function $E(e,t){return new Promise(r=>{y.with(ar(y.active()),()=>{e.export(t,n=>{r(n)})})})}var kE=p(()=>{g();ir()});var qE,B=p(()=>{oE();iE();cE();hE();mE();Zo();OE();xE();ir();Qo();HE();Jo();YE();kE();qE={_export:$E}});function fn(){return`unknown_service:${process.argv0}`}var jE=p(()=>{});var KE=p(()=>{jE()});var XE=p(()=>{KE()});var Ie,WE=p(()=>{g();en();B();XE();Ie=class e{constructor(t,r){var n;this._attributes=t,this.asyncAttributesPending=r!=null,this._syncAttributes=(n=this._attributes)!==null&&n!==void 0?n:{},this._asyncAttributesPromise=r==null?void 0:r.then(o=>(this._attributes=Object.assign({},this._attributes,o),this.asyncAttributesPending=!1,o),o=>(O.debug("a resource's async attributes promise rejected: %s",o),this.asyncAttributesPending=!1,{}))}static empty(){return e.EMPTY}static default(){return new e({[qi]:fn(),[or]:ot[or],[nr]:ot[nr],[sr]:ot[sr]})}get attributes(){var t;return this.asyncAttributesPending&&O.error("Accessing resource attributes before async attributes settled"),(t=this._attributes)!==null&&t!==void 0?t:{}}async waitForAsyncAttributes(){this.asyncAttributesPending&&await this._asyncAttributesPromise}merge(t){var r;if(!t)return this;let n=Object.assign(Object.assign({},this._syncAttributes),(r=t._syncAttributes)!==null&&r!==void 0?r:t.attributes);if(!this._asyncAttributesPromise&&!t._asyncAttributesPromise)return new e(n);let o=Promise.all([this._asyncAttributesPromise,t._asyncAttributesPromise]).then(([s,a])=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign({},this._syncAttributes),s),(i=t._syncAttributes)!==null&&i!==void 0?i:t.attributes),a)});return new e(n,o)}};Ie.EMPTY=new Ie({})});var is=p(()=>{WE()});var Ts=m(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.AbstractAsyncHooksContextManager=void 0;var vl=Lo("events"),Pl=["addListener","on","once","prependListener","prependOnceListener"],ps=class{constructor(){this._kOtListeners=Symbol("OtListeners"),this._wrapped=!1}bind(t,r){return r instanceof vl.EventEmitter?this._bindEventEmitter(t,r):typeof r=="function"?this._bindFunction(t,r):r}_bindFunction(t,r){let n=this,o=function(...s){return n.with(t,()=>r.apply(this,s))};return Object.defineProperty(o,"length",{enumerable:!1,configurable:!0,writable:!1,value:r.length}),o}_bindEventEmitter(t,r){return this._getPatchMap(r)!==void 0||(this._createPatchMap(r),Pl.forEach(o=>{r[o]!==void 0&&(r[o]=this._patchAddListener(r,r[o],t))}),typeof r.removeListener=="function"&&(r.removeListener=this._patchRemoveListener(r,r.removeListener)),typeof r.off=="function"&&(r.off=this._patchRemoveListener(r,r.off)),typeof r.removeAllListeners=="function"&&(r.removeAllListeners=this._patchRemoveAllListeners(r,r.removeAllListeners))),r}_patchRemoveListener(t,r){let n=this;return function(o,s){var a;let i=(a=n._getPatchMap(t))===null||a===void 0?void 0:a[o];if(i===void 0)return r.call(this,o,s);let E=i.get(s);return r.call(this,o,E||s)}}_patchRemoveAllListeners(t,r){let n=this;return function(o){let s=n._getPatchMap(t);return s!==void 0&&(arguments.length===0?n._createPatchMap(t):s[o]!==void 0&&delete s[o]),r.apply(this,arguments)}}_patchAddListener(t,r,n){let o=this;return function(s,a){if(o._wrapped)return r.call(this,s,a);let i=o._getPatchMap(t);i===void 0&&(i=o._createPatchMap(t));let E=i[s];E===void 0&&(E=new WeakMap,i[s]=E);let _=o.bind(n,a);E.set(a,_),o._wrapped=!0;try{return r.call(this,s,_)}finally{o._wrapped=!1}}}_createPatchMap(t){let r=Object.create(null);return t[this._kOtListeners]=r,r}_getPatchMap(t){return t[this._kOtListeners]}};On.AbstractAsyncHooksContextManager=ps});var t_=m(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});Nn.AsyncHooksContextManager=void 0;var gl=(g(),Tt(St)),Ll=Lo("async_hooks"),Cl=Ts(),us=class extends Cl.AbstractAsyncHooksContextManager{constructor(){super(),this._contexts=new Map,this._stack=[],this._asyncHook=Ll.createHook({init:this._init.bind(this),before:this._before.bind(this),after:this._after.bind(this),destroy:this._destroy.bind(this),promiseResolve:this._destroy.bind(this)})}active(){var t;return(t=this._stack[this._stack.length-1])!==null&&t!==void 0?t:gl.ROOT_CONTEXT}with(t,r,n,...o){this._enterContext(t);try{return r.call(n,...o)}finally{this._exitContext()}}enable(){return this._asyncHook.enable(),this}disable(){return this._asyncHook.disable(),this._contexts.clear(),this._stack=[],this}_init(t,r){if(r==="TIMERWRAP")return;let n=this._stack[this._stack.length-1];n!==void 0&&this._contexts.set(t,n)}_destroy(t){this._contexts.delete(t)}_before(t){let r=this._contexts.get(t);r!==void 0&&this._enterContext(r)}_after(){this._exitContext()}_enterContext(t){this._stack.push(t)}_exitContext(){this._stack.pop()}};Nn.AsyncHooksContextManager=us});var r_=m(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.AsyncLocalStorageContextManager=void 0;var Il=(g(),Tt(St)),Ml=Lo("async_hooks"),xl=Ts(),Ss=class extends xl.AbstractAsyncHooksContextManager{constructor(){super(),this._asyncLocalStorage=new Ml.AsyncLocalStorage}active(){var t;return(t=this._asyncLocalStorage.getStore())!==null&&t!==void 0?t:Il.ROOT_CONTEXT}with(t,r,n,...o){let s=n==null?r:r.bind(n);return this._asyncLocalStorage.run(t,s,...o)}enable(){return this}disable(){return this._asyncLocalStorage.disable(),this}};vn.AsyncLocalStorageContextManager=Ss});var n_=m(dt=>{"use strict";Object.defineProperty(dt,"__esModule",{value:!0});dt.AsyncLocalStorageContextManager=dt.AsyncHooksContextManager=void 0;var Dl=t_();Object.defineProperty(dt,"AsyncHooksContextManager",{enumerable:!0,get:function(){return Dl.AsyncHooksContextManager}});var Ul=r_();Object.defineProperty(dt,"AsyncLocalStorageContextManager",{enumerable:!0,get:function(){return Ul.AsyncLocalStorageContextManager}})});var Rt,ls=p(()=>{g();Rt=Le("OpenTelemetry Context Key B3 Debug Flag")});var ht,mt,Ot,Nt,Pn,vt,As=p(()=>{ht="b3",mt="x-b3-traceid",Ot="x-b3-spanid",Nt="x-b3-sampled",Pn="x-b3-parentspanid",vt="x-b3-flags"});function Vl(e){return e===L.SAMPLED||e===L.NONE}function wl(e){return Array.isArray(e)?e[0]:e}function Ln(e,t,r){let n=t.get(e,r);return wl(n)}function Gl(e,t){let r=Ln(e,t,mt);return typeof r=="string"?r.padStart(32,"0"):""}function Bl(e,t){let r=Ln(e,t,Ot);return typeof r=="string"?r:""}function o_(e,t){return Ln(e,t,vt)==="1"?"1":void 0}function Hl(e,t){let r=Ln(e,t,Nt);if(o_(e,t)==="1"||yl.has(r))return L.SAMPLED;if(r===void 0||bl.has(r))return L.NONE}var yl,bl,gn,s_=p(()=>{g();B();ls();As();yl=new Set([!0,"true","True","1",1]),bl=new Set([!1,"false","False","0",0]);gn=class{inject(t,r,n){let o=P.getSpanContext(t);if(!o||!ne(o)||z(t))return;let s=t.getValue(Rt);n.set(r,mt,o.traceId),n.set(r,Ot,o.spanId),s==="1"?n.set(r,vt,s):o.traceFlags!==void 0&&n.set(r,Nt,(L.SAMPLED&o.traceFlags)===L.SAMPLED?"1":"0")}extract(t,r,n){let o=Gl(r,n),s=Bl(r,n),a=Hl(r,n),i=o_(r,n);return we(o)&&tt(s)&&Vl(a)?(t=t.setValue(Rt,i),P.setSpanContext(t,{traceId:o,spanId:s,isRemote:!0,traceFlags:a})):t}fields(){return[mt,Ot,vt,Nt,Pn]}}});function ql(e){return e.length===32?e:`${Yl}${e}`}function jl(e){return e&&$l.has(e)?L.SAMPLED:L.NONE}var Fl,Yl,$l,kl,Cn,a_=p(()=>{g();B();ls();Fl=/((?:[0-9a-f]{16}){1,2})-([0-9a-f]{16})(?:-([01d](?![0-9a-f])))?(?:-([0-9a-f]{16}))?/,Yl="0".repeat(16),$l=new Set(["d","1"]),kl="d";Cn=class{inject(t,r,n){let o=P.getSpanContext(t);if(!o||!ne(o)||z(t))return;let s=t.getValue(Rt)||o.traceFlags&1,a=`${o.traceId}-${o.spanId}-${s}`;n.set(r,"b3",a)}extract(t,r,n){let o=n.get(r,"b3"),s=Array.isArray(o)?o[0]:o;if(typeof s!="string")return t;let a=s.match(Fl);if(!a)return t;let[,i,E,_]=a,c=ql(i);if(!we(c)||!tt(E))return t;let T=jl(_);return _===kl&&(t=t.setValue(Rt,_)),P.setSpanContext(t,{traceId:c,spanId:E,isRemote:!0,traceFlags:T})}fields(){return["b3"]}}});var Pt,fs=p(()=>{(function(e){e[e.SINGLE_HEADER=0]="SINGLE_HEADER",e[e.MULTI_HEADER=1]="MULTI_HEADER"})(Pt||(Pt={}))});var In,i_=p(()=>{B();s_();a_();fs();In=class{constructor(t={}){this._b3MultiPropagator=new gn,this._b3SinglePropagator=new Cn,t.injectEncoding===Pt.MULTI_HEADER?(this._inject=this._b3MultiPropagator.inject,this._fields=this._b3MultiPropagator.fields()):(this._inject=this._b3SinglePropagator.inject,this._fields=this._b3SinglePropagator.fields())}inject(t,r,n){z(t)||this._inject(t,r,n)}extract(t,r,n){let o=n.get(r,"b3");return(Array.isArray(o)?o[0]:o)?this._b3SinglePropagator.extract(t,r,n):this._b3MultiPropagator.extract(t,r,n)}fields(){return this._fields}}});var E_={};Je(E_,{B3InjectEncoding:()=>Pt,B3Propagator:()=>In,B3_CONTEXT_HEADER:()=>ht,X_B3_FLAGS:()=>vt,X_B3_PARENT_SPAN_ID:()=>Pn,X_B3_SAMPLED:()=>Nt,X_B3_SPAN_ID:()=>Ot,X_B3_TRACE_ID:()=>mt});var __=p(()=>{i_();As();fs()});var c_,p_=p(()=>{c_="exception"});var gt,ds=p(()=>{g();B();en();p_();gt=class{constructor(t,r,n,o,s,a,i=[],E,_,c){this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:F.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=o,this.parentSpanId=a,this.kind=s,this.links=i;let T=Date.now();this._performanceStartTime=me.now(),this._performanceOffset=T-(this._performanceStartTime+sn()),this._startTimeProvided=E!=null,this.startTime=this._getTime(E??T),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this._spanLimits=t.getSpanLimits(),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,c!=null&&this.setAttributes(c),this._spanProcessor=t.getActiveSpanProcessor(),this._spanProcessor.onStart(this,r)}spanContext(){return this._spanContext}setAttribute(t,r){return r==null||this._isSpanEnded()?this:t.length===0?(O.warn(`Invalid attribute key: ${t}`),this):rn(r)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this._droppedAttributesCount++,this):(this.attributes[t]=this._truncateToSize(r),this):(O.warn(`Invalid attribute value set for key: ${t}`),this)}setAttributes(t){for(let[r,n]of Object.entries(t))this.setAttribute(r,n);return this}addEvent(t,r,n){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return O.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(this._droppedEventsCount===0&&O.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),_n(r)&&(_n(n)||(n=r),r=void 0);let o=nt(r);return this.events.push({name:t,attributes:o,time:this._getTime(n),droppedAttributesCount:0}),this}addLink(t){return this.links.push(t),this}addLinks(t){return this.links.push(...t),this}setStatus(t){return this._isSpanEnded()?this:(this.status=Object.assign({},t),this.status.message!=null&&typeof t.message!="string"&&(O.warn(`Dropping invalid status.message of type '${typeof t.message}', expected 'string'`),delete this.status.message),this)}updateName(t){return this._isSpanEnded()?this:(this.name=t,this)}end(t){if(this._isSpanEnded()){O.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`);return}this._ended=!0,this.endTime=this._getTime(t),this._duration=rs(this.startTime,this.endTime),this._duration[0]<0&&(O.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&O.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this)}_getTime(t){if(typeof t=="number"&&t<=me.now())return ts(t+this._performanceOffset);if(typeof t=="number")return ke(t);if(t instanceof Date)return ke(t.getTime());if(En(t))return t;if(this._startTimeProvided)return ke(Date.now());let r=me.now()-this._performanceStartTime;return cn(this.startTime,ke(r))}isRecording(){return this._ended===!1}recordException(t,r){let n={};typeof t=="string"?n[Zr]=t:t&&(t.code?n[Qr]=t.code.toString():t.name&&(n[Qr]=t.name),t.message&&(n[Zr]=t.message),t.stack&&(n[Fi]=t.stack)),n[Qr]||n[Zr]?this.addEvent(c_,n,r):O.warn(`Failed to record an exception ${t}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){return this._ended&&O.warn(`Can not execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`),this._ended}_truncateToLimitUtil(t,r){return t.length<=r?t:t.substring(0,r)}_truncateToSize(t){let r=this._attributeValueLengthLimit;return r<=0?(O.warn(`Attribute value limit must be positive, got ${r}`),t):typeof t=="string"?this._truncateToLimitUtil(t,r):Array.isArray(t)?t.map(n=>typeof n=="string"?this._truncateToLimitUtil(n,r):n):t}}});var Oe,Ar=p(()=>{(function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Oe||(Oe={}))});var Me,Mn=p(()=>{Ar();Me=class{shouldSample(){return{decision:Oe.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}});var ue,xn=p(()=>{Ar();ue=class{shouldSample(){return{decision:Oe.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}});var qe,Rs=p(()=>{g();B();Mn();xn();qe=class{constructor(t){var r,n,o,s;this._root=t.root,this._root||(Te(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new ue),this._remoteParentSampled=(r=t.remoteParentSampled)!==null&&r!==void 0?r:new ue,this._remoteParentNotSampled=(n=t.remoteParentNotSampled)!==null&&n!==void 0?n:new Me,this._localParentSampled=(o=t.localParentSampled)!==null&&o!==void 0?o:new ue,this._localParentNotSampled=(s=t.localParentNotSampled)!==null&&s!==void 0?s:new Me}shouldSample(t,r,n,o,s,a){let i=P.getSpanContext(t);return!i||!ne(i)?this._root.shouldSample(t,r,n,o,s,a):i.isRemote?i.traceFlags&L.SAMPLED?this._remoteParentSampled.shouldSample(t,r,n,o,s,a):this._remoteParentNotSampled.shouldSample(t,r,n,o,s,a):i.traceFlags&L.SAMPLED?this._localParentSampled.shouldSample(t,r,n,o,s,a):this._localParentNotSampled.shouldSample(t,r,n,o,s,a)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}}});var at,hs=p(()=>{g();Ar();at=class{constructor(t=0){this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(t,r){return{decision:we(r)&&this._accumulate(r)<this._upperBound?Oe.RECORD_AND_SAMPLED:Oe.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(t){return typeof t!="number"||isNaN(t)?0:t>=1?1:t<=0?0:t}_accumulate(t){let r=0;for(let n=0;n<t.length/8;n++){let o=n*8,s=parseInt(t.slice(o,o+8),16);r=(r^s)>>>0}return r}}});function Dn(){let e=he();return{sampler:ms(e),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:e.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:e.OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:e.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:e.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:e.OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:e.OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:e.OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:e.OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT},mergeResourceWithDefaults:!0}}function ms(e=he()){switch(e.OTEL_TRACES_SAMPLER){case Ee.AlwaysOn:return new ue;case Ee.AlwaysOff:return new Me;case Ee.ParentBasedAlwaysOn:return new qe({root:new ue});case Ee.ParentBasedAlwaysOff:return new qe({root:new Me});case Ee.TraceIdRatio:return new at(T_(e));case Ee.ParentBasedTraceIdRatio:return new qe({root:new at(T_(e))});default:return O.error(`OTEL_TRACES_SAMPLER value "${e.OTEL_TRACES_SAMPLER} invalid, defaulting to ${Kl}".`),new ue}}function T_(e){if(e.OTEL_TRACES_SAMPLER_ARG===void 0||e.OTEL_TRACES_SAMPLER_ARG==="")return O.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${Lt}.`),Lt;let t=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(O.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${Lt}.`),Lt):t<0||t>1?(O.error(`OTEL_TRACES_SAMPLER_ARG=${e.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${Lt}.`),Lt):t}var Kl,Lt,Os=p(()=>{g();B();Mn();xn();Rs();hs();Kl=Ee.AlwaysOn,Lt=1});function u_(e){let t={sampler:ms()},r=Dn(),n=Object.assign({},r,t,e);return n.generalLimits=Object.assign({},r.generalLimits,e.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,e.spanLimits||{}),n}function S_(e){var t,r,n,o,s,a,i,E,_,c,T,l;let f=Object.assign({},e.spanLimits),C=_r();return f.attributeCountLimit=(a=(s=(o=(r=(t=e.spanLimits)===null||t===void 0?void 0:t.attributeCountLimit)!==null&&r!==void 0?r:(n=e.generalLimits)===null||n===void 0?void 0:n.attributeCountLimit)!==null&&o!==void 0?o:C.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&s!==void 0?s:C.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&a!==void 0?a:At,f.attributeValueLengthLimit=(l=(T=(c=(E=(i=e.spanLimits)===null||i===void 0?void 0:i.attributeValueLengthLimit)!==null&&E!==void 0?E:(_=e.generalLimits)===null||_===void 0?void 0:_.attributeValueLengthLimit)!==null&&c!==void 0?c:C.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&T!==void 0?T:C.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&l!==void 0?l:lt,Object.assign({},e,{spanLimits:f})}var Ns=p(()=>{Os();B()});var Un,l_=p(()=>{g();B();Un=class{constructor(t,r){this._exporter=t,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;let n=he();this._maxExportBatchSize=typeof(r==null?void 0:r.maxExportBatchSize)=="number"?r.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof(r==null?void 0:r.maxQueueSize)=="number"?r.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof(r==null?void 0:r.scheduledDelayMillis)=="number"?r.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof(r==null?void 0:r.exportTimeoutMillis)=="number"?r.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new Be(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(O.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(t,r){}onEnd(t){this._shutdownOnce.isCalled||(t.spanContext().traceFlags&L.SAMPLED)!==0&&this._addToBuffer(t)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(t){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&O.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(O.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()}_flushAll(){return new Promise((t,r)=>{let n=[],o=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let s=0,a=o;s<a;s++)n.push(this._flushOneBatch());Promise.all(n).then(()=>{t()}).catch(r)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((t,r)=>{let n=setTimeout(()=>{r(new Error("Timeout"))},this._exportTimeoutMillis);y.with(ar(y.active()),()=>{let o;this._finishedSpans.length<=this._maxExportBatchSize?(o=this._finishedSpans,this._finishedSpans=[]):o=this._finishedSpans.splice(0,this._maxExportBatchSize);let s=()=>this._exporter.export(o,i=>{var E;clearTimeout(n),i.code===J.SUCCESS?t():r((E=i.error)!==null&&E!==void 0?E:new Error("BatchSpanProcessor: span export failed"))}),a=null;for(let i=0,E=o.length;i<E;i++){let _=o[i];_.resource.asyncAttributesPending&&_.resource.waitForAsyncAttributes&&(a??(a=[]),a.push(_.resource.waitForAsyncAttributes()))}a===null?s():Promise.all(a).then(s,i=>{Te(i),r(i)})})})}_maybeStartTimer(){if(this._isExporting)return;let t=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(r=>{this._isExporting=!1,Te(r)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();this._timer===void 0&&(this._timer=setTimeout(()=>t(),this._scheduledDelayMillis),cr(this._timer))}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}}});var je,A_=p(()=>{l_();je=class extends Un{onShutdown(){}}});function f_(e){return function(){for(let r=0;r<e/4;r++)yn.writeUInt32BE(Math.random()*2**32>>>0,r*4);for(let r=0;r<e&&!(yn[r]>0);r++)r===e-1&&(yn[e-1]=1);return yn.toString("hex",0,e)}}var Ke,yn,d_=p(()=>{Ke=class{constructor(){this.generateTraceId=f_(16),this.generateSpanId=f_(8)}},yn=Buffer.allocUnsafe(16)});var R_=p(()=>{A_();d_()});var bn=p(()=>{R_()});var Ct,vs=p(()=>{g();B();ds();Ns();bn();Ct=class{constructor(t,r,n){this._tracerProvider=n;let o=u_(r);this._sampler=o.sampler,this._generalLimits=o.generalLimits,this._spanLimits=o.spanLimits,this._idGenerator=r.idGenerator||new Ke,this.resource=n.resource,this.instrumentationLibrary=t}startSpan(t,r={},n=y.active()){var o,s,a;r.root&&(n=P.deleteSpan(n));let i=P.getSpan(n);if(z(n))return O.debug("Instrumentation suppressed, returning Noop Span"),P.wrapSpanContext(ut);let E=i==null?void 0:i.spanContext(),_=this._idGenerator.generateSpanId(),c,T,l;!E||!P.isSpanContextValid(E)?c=this._idGenerator.generateTraceId():(c=E.traceId,T=E.traceState,l=E.spanId);let f=(o=r.kind)!==null&&o!==void 0?o:oe.INTERNAL,C=((s=r.links)!==null&&s!==void 0?s:[]).map(M=>({context:M.context,attributes:nt(M.attributes)})),V=nt(r.attributes),q=this._sampler.shouldSample(n,c,t,f,V,C);T=(a=q.traceState)!==null&&a!==void 0?a:T;let re=q.decision===rt.RECORD_AND_SAMPLED?L.SAMPLED:L.NONE,pe={traceId:c,spanId:_,traceFlags:re,traceState:T};if(q.decision===rt.NOT_RECORD)return O.debug("Recording is off, propagating context in a non-recording span"),P.wrapSpanContext(pe);let U=nt(Object.assign(V,q.attributes));return new gt(this,n,t,pe,f,l,C,r.startTime,void 0,U)}startActiveSpan(t,r,n,o){let s,a,i;if(arguments.length<2)return;arguments.length===2?i=r:arguments.length===3?(s=r,i=n):(s=r,a=n,i=o);let E=a??y.active(),_=this.startSpan(t,s,E),c=P.setSpan(E,_);return y.with(c,i,void 0,_)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}}});var fr,h_=p(()=>{B();fr=class{constructor(t){this._spanProcessors=t}forceFlush(){let t=[];for(let r of this._spanProcessors)t.push(r.forceFlush());return new Promise(r=>{Promise.all(t).then(()=>{r()}).catch(n=>{Te(n||new Error("MultiSpanProcessor: forceFlush failed")),r()})})}onStart(t,r){for(let n of this._spanProcessors)n.onStart(t,r)}onEnd(t){for(let r of this._spanProcessors)r.onEnd(t)}shutdown(){let t=[];for(let r of this._spanProcessors)t.push(r.shutdown());return new Promise((r,n)=>{Promise.all(t).then(()=>{r()},n)})}}});var It,Ps=p(()=>{It=class{onStart(t,r){}onEnd(t){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}}});var He,Mt,m_=p(()=>{g();B();is();vs();Os();h_();Ps();bn();Ns();(function(e){e[e.resolved=0]="resolved",e[e.timeout=1]="timeout",e[e.error=2]="error",e[e.unresolved=3]="unresolved"})(He||(He={}));Mt=class{constructor(t={}){var r,n;this._registeredSpanProcessors=[],this._tracers=new Map;let o=as({},Dn(),S_(t));if(this.resource=(r=o.resource)!==null&&r!==void 0?r:Ie.empty(),o.mergeResourceWithDefaults&&(this.resource=Ie.default().merge(this.resource)),this._config=Object.assign({},o,{resource:this.resource}),!((n=t.spanProcessors)===null||n===void 0)&&n.length)this._registeredSpanProcessors=[...t.spanProcessors],this.activeSpanProcessor=new fr(this._registeredSpanProcessors);else{let s=this._buildExporterFromEnv();if(s!==void 0){let a=new je(s);this.activeSpanProcessor=a}else this.activeSpanProcessor=new It}}getTracer(t,r,n){let o=`${t}@${r||""}:${(n==null?void 0:n.schemaUrl)||""}`;return this._tracers.has(o)||this._tracers.set(o,new Ct({name:t,version:r,schemaUrl:n==null?void 0:n.schemaUrl},this._config,this)),this._tracers.get(o)}addSpanProcessor(t){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(r=>O.error("Error while trying to shutdown current span processor",r)),this._registeredSpanProcessors.push(t),this.activeSpanProcessor=new fr(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(t={}){P.setGlobalTracerProvider(this),t.propagator===void 0&&(t.propagator=this._buildPropagatorFromEnv()),t.contextManager&&y.setGlobalContextManager(t.contextManager),t.propagator&&K.setGlobalPropagator(t.propagator)}forceFlush(){let t=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map(n=>new Promise(o=>{let s,a=setTimeout(()=>{o(new Error(`Span processor did not completed within timeout period of ${t} ms`)),s=He.timeout},t);n.forceFlush().then(()=>{clearTimeout(a),s!==He.timeout&&(s=He.resolved,o(s))}).catch(i=>{clearTimeout(a),s=He.error,o(i)})}));return new Promise((n,o)=>{Promise.all(r).then(s=>{let a=s.filter(i=>i!==He.resolved);a.length>0?o(a):n()}).catch(s=>o([s]))})}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(t){var r;return(r=this.constructor._registeredPropagators.get(t))===null||r===void 0?void 0:r()}_getSpanExporter(t){var r;return(r=this.constructor._registeredExporters.get(t))===null||r===void 0?void 0:r()}_buildPropagatorFromEnv(){let t=Array.from(new Set(he().OTEL_PROPAGATORS)),n=t.map(o=>{let s=this._getPropagator(o);return s||O.warn(`Propagator "${o}" requested through environment variable is unavailable.`),s}).reduce((o,s)=>(s&&o.push(s),o),[]);if(n.length!==0)return t.length===1?n[0]:new pr({propagators:n})}_buildExporterFromEnv(){let t=he().OTEL_TRACES_EXPORTER;if(t==="none"||t==="")return;let r=this._getSpanExporter(t);return r||O.error(`Exporter "${t}" requested through environment variable is unavailable.`),r}};Mt._registeredPropagators=new Map([["tracecontext",()=>new Ge],["baggage",()=>new Er]]);Mt._registeredExporters=new Map});var Vn,O_=p(()=>{B();Vn=class{export(t,r){return this._sendSpans(t,r)}shutdown(){return this._sendSpans([]),this.forceFlush()}forceFlush(){return Promise.resolve()}_exportInfo(t){var r;return{resource:{attributes:t.resource.attributes},instrumentationScope:t.instrumentationLibrary,traceId:t.spanContext().traceId,parentId:t.parentSpanId,traceState:(r=t.spanContext().traceState)===null||r===void 0?void 0:r.serialize(),name:t.name,id:t.spanContext().spanId,kind:t.kind,timestamp:an(t.startTime),duration:an(t.duration),attributes:t.attributes,status:t.status,events:t.events,links:t.links}}_sendSpans(t,r){for(let n of t)console.dir(this._exportInfo(n),{depth:3});if(r)return r({code:J.SUCCESS})}}});var wn,N_=p(()=>{B();wn=class{constructor(){this._finishedSpans=[],this._stopped=!1}export(t,r){if(this._stopped)return r({code:J.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...t),setTimeout(()=>r({code:J.SUCCESS}),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],this.forceFlush()}forceFlush(){return Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}}});var Gn,v_=p(()=>{g();B();Gn=class{constructor(t){this._exporter=t,this._shutdownOnce=new Be(this._shutdown,this),this._unresolvedExports=new Set}async forceFlush(){await Promise.all(Array.from(this._unresolvedExports)),this._exporter.forceFlush&&await this._exporter.forceFlush()}onStart(t,r){}onEnd(t){var r,n;if(this._shutdownOnce.isCalled||(t.spanContext().traceFlags&L.SAMPLED)===0)return;let o=()=>qE._export(this._exporter,[t]).then(s=>{var a;s.code!==J.SUCCESS&&Te((a=s.error)!==null&&a!==void 0?a:new Error(`SimpleSpanProcessor: span export failed (status ${s})`))}).catch(s=>{Te(s)});if(t.resource.asyncAttributesPending){let s=(n=(r=t.resource).waitForAsyncAttributes)===null||n===void 0?void 0:n.call(r).then(()=>(s!=null&&this._unresolvedExports.delete(s),o()),a=>Te(a));s!=null&&this._unresolvedExports.add(s)}else o()}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}}});var gs={};Je(gs,{AlwaysOffSampler:()=>Me,AlwaysOnSampler:()=>ue,BasicTracerProvider:()=>Mt,BatchSpanProcessor:()=>je,ConsoleSpanExporter:()=>Vn,ForceFlushState:()=>He,InMemorySpanExporter:()=>wn,NoopSpanProcessor:()=>It,ParentBasedSampler:()=>qe,RandomIdGenerator:()=>Ke,SamplingDecision:()=>Oe,SimpleSpanProcessor:()=>Gn,Span:()=>gt,TraceIdRatioBasedSampler:()=>at,Tracer:()=>Ct});var Ls=p(()=>{vs();m_();bn();O_();N_();v_();Ps();Mn();xn();Rs();hs();Ar();ds()});var dr=m((Qg,P_)=>{"use strict";var Xl="2.0.0",Wl=Number.MAX_SAFE_INTEGER||9007199254740991,zl=16,Jl=250,Ql=["major","premajor","minor","preminor","patch","prepatch","prerelease"];P_.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:zl,MAX_SAFE_BUILD_LENGTH:Jl,MAX_SAFE_INTEGER:Wl,RELEASE_TYPES:Ql,SEMVER_SPEC_VERSION:Xl,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Rr=m((Zg,g_)=>{"use strict";var Zl=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};g_.exports=Zl});var xt=m((xe,L_)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Cs,MAX_SAFE_BUILD_LENGTH:eA,MAX_LENGTH:tA}=dr(),rA=Rr();xe=L_.exports={};var nA=xe.re=[],oA=xe.safeRe=[],d=xe.src=[],sA=xe.safeSrc=[],R=xe.t={},aA=0,Is="[a-zA-Z0-9-]",iA=[["\\s",1],["\\d",tA],[Is,eA]],EA=e=>{for(let[t,r]of iA)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e},N=(e,t,r)=>{let n=EA(t),o=aA++;rA(e,o,t),R[e]=o,d[o]=t,sA[o]=n,nA[o]=new RegExp(t,r?"g":void 0),oA[o]=new RegExp(n,r?"g":void 0)};N("NUMERICIDENTIFIER","0|[1-9]\\d*");N("NUMERICIDENTIFIERLOOSE","\\d+");N("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Is}*`);N("MAINVERSION",`(${d[R.NUMERICIDENTIFIER]})\\.(${d[R.NUMERICIDENTIFIER]})\\.(${d[R.NUMERICIDENTIFIER]})`);N("MAINVERSIONLOOSE",`(${d[R.NUMERICIDENTIFIERLOOSE]})\\.(${d[R.NUMERICIDENTIFIERLOOSE]})\\.(${d[R.NUMERICIDENTIFIERLOOSE]})`);N("PRERELEASEIDENTIFIER",`(?:${d[R.NONNUMERICIDENTIFIER]}|${d[R.NUMERICIDENTIFIER]})`);N("PRERELEASEIDENTIFIERLOOSE",`(?:${d[R.NONNUMERICIDENTIFIER]}|${d[R.NUMERICIDENTIFIERLOOSE]})`);N("PRERELEASE",`(?:-(${d[R.PRERELEASEIDENTIFIER]}(?:\\.${d[R.PRERELEASEIDENTIFIER]})*))`);N("PRERELEASELOOSE",`(?:-?(${d[R.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${d[R.PRERELEASEIDENTIFIERLOOSE]})*))`);N("BUILDIDENTIFIER",`${Is}+`);N("BUILD",`(?:\\+(${d[R.BUILDIDENTIFIER]}(?:\\.${d[R.BUILDIDENTIFIER]})*))`);N("FULLPLAIN",`v?${d[R.MAINVERSION]}${d[R.PRERELEASE]}?${d[R.BUILD]}?`);N("FULL",`^${d[R.FULLPLAIN]}$`);N("LOOSEPLAIN",`[v=\\s]*${d[R.MAINVERSIONLOOSE]}${d[R.PRERELEASELOOSE]}?${d[R.BUILD]}?`);N("LOOSE",`^${d[R.LOOSEPLAIN]}$`);N("GTLT","((?:<|>)?=?)");N("XRANGEIDENTIFIERLOOSE",`${d[R.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);N("XRANGEIDENTIFIER",`${d[R.NUMERICIDENTIFIER]}|x|X|\\*`);N("XRANGEPLAIN",`[v=\\s]*(${d[R.XRANGEIDENTIFIER]})(?:\\.(${d[R.XRANGEIDENTIFIER]})(?:\\.(${d[R.XRANGEIDENTIFIER]})(?:${d[R.PRERELEASE]})?${d[R.BUILD]}?)?)?`);N("XRANGEPLAINLOOSE",`[v=\\s]*(${d[R.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[R.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[R.XRANGEIDENTIFIERLOOSE]})(?:${d[R.PRERELEASELOOSE]})?${d[R.BUILD]}?)?)?`);N("XRANGE",`^${d[R.GTLT]}\\s*${d[R.XRANGEPLAIN]}$`);N("XRANGELOOSE",`^${d[R.GTLT]}\\s*${d[R.XRANGEPLAINLOOSE]}$`);N("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Cs}})(?:\\.(\\d{1,${Cs}}))?(?:\\.(\\d{1,${Cs}}))?`);N("COERCE",`${d[R.COERCEPLAIN]}(?:$|[^\\d])`);N("COERCEFULL",d[R.COERCEPLAIN]+`(?:${d[R.PRERELEASE]})?(?:${d[R.BUILD]})?(?:$|[^\\d])`);N("COERCERTL",d[R.COERCE],!0);N("COERCERTLFULL",d[R.COERCEFULL],!0);N("LONETILDE","(?:~>?)");N("TILDETRIM",`(\\s*)${d[R.LONETILDE]}\\s+`,!0);xe.tildeTrimReplace="$1~";N("TILDE",`^${d[R.LONETILDE]}${d[R.XRANGEPLAIN]}$`);N("TILDELOOSE",`^${d[R.LONETILDE]}${d[R.XRANGEPLAINLOOSE]}$`);N("LONECARET","(?:\\^)");N("CARETTRIM",`(\\s*)${d[R.LONECARET]}\\s+`,!0);xe.caretTrimReplace="$1^";N("CARET",`^${d[R.LONECARET]}${d[R.XRANGEPLAIN]}$`);N("CARETLOOSE",`^${d[R.LONECARET]}${d[R.XRANGEPLAINLOOSE]}$`);N("COMPARATORLOOSE",`^${d[R.GTLT]}\\s*(${d[R.LOOSEPLAIN]})$|^$`);N("COMPARATOR",`^${d[R.GTLT]}\\s*(${d[R.FULLPLAIN]})$|^$`);N("COMPARATORTRIM",`(\\s*)${d[R.GTLT]}\\s*(${d[R.LOOSEPLAIN]}|${d[R.XRANGEPLAIN]})`,!0);xe.comparatorTrimReplace="$1$2$3";N("HYPHENRANGE",`^\\s*(${d[R.XRANGEPLAIN]})\\s+-\\s+(${d[R.XRANGEPLAIN]})\\s*$`);N("HYPHENRANGELOOSE",`^\\s*(${d[R.XRANGEPLAINLOOSE]})\\s+-\\s+(${d[R.XRANGEPLAINLOOSE]})\\s*$`);N("STAR","(<|>)?=?\\s*\\*");N("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");N("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Bn=m((eL,C_)=>{"use strict";var _A=Object.freeze({loose:!0}),cA=Object.freeze({}),pA=e=>e?typeof e!="object"?_A:e:cA;C_.exports=pA});var Ms=m((tL,x_)=>{"use strict";var I_=/^[0-9]+$/,M_=(e,t)=>{if(typeof e=="number"&&typeof t=="number")return e===t?0:e<t?-1:1;let r=I_.test(e),n=I_.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1},TA=(e,t)=>M_(t,e);x_.exports={compareIdentifiers:M_,rcompareIdentifiers:TA}});var X=m((rL,U_)=>{"use strict";var Hn=Rr(),{MAX_LENGTH:D_,MAX_SAFE_INTEGER:Fn}=dr(),{safeRe:Yn,t:$n}=xt(),uA=Bn(),{compareIdentifiers:xs}=Ms(),Ds=class e{constructor(t,r){if(r=uA(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>D_)throw new TypeError(`version is longer than ${D_} characters`);Hn("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=t.trim().match(r.loose?Yn[$n.LOOSE]:Yn[$n.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Fn||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Fn||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Fn||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let s=+o;if(s>=0&&s<Fn)return s}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Hn("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if(typeof t=="string"&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),this.major<t.major?-1:this.major>t.major?1:this.minor<t.minor?-1:this.minor>t.minor?1:this.patch<t.patch?-1:this.patch>t.patch?1:0}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],o=t.prerelease[r];if(Hn("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return xs(n,o)}while(++r)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let r=0;do{let n=this.build[r],o=t.build[r];if(Hn("build compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return xs(n,o)}while(++r)}inc(t,r,n){if(t.startsWith("pre")){if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let o=`-${r}`.match(this.options.loose?Yn[$n.PRERELEASELOOSE]:Yn[$n.PRERELEASE]);if(!o||o[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[o];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(r){let s=[r,o];n===!1&&(s=[r]),xs(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};U_.exports=Ds});var it=m((nL,b_)=>{"use strict";var y_=X(),SA=(e,t,r=!1)=>{if(e instanceof y_)return e;try{return new y_(e,t)}catch(n){if(!r)return null;throw n}};b_.exports=SA});var w_=m((oL,V_)=>{"use strict";var lA=it(),AA=(e,t)=>{let r=lA(e,t);return r?r.version:null};V_.exports=AA});var B_=m((sL,G_)=>{"use strict";var fA=it(),dA=(e,t)=>{let r=fA(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};G_.exports=dA});var Y_=m((aL,F_)=>{"use strict";var H_=X(),RA=(e,t,r,n,o)=>{typeof r=="string"&&(o=n,n=r,r=void 0);try{return new H_(e instanceof H_?e.version:e,r).inc(t,n,o).version}catch{return null}};F_.exports=RA});var q_=m((iL,k_)=>{"use strict";var $_=it(),hA=(e,t)=>{let r=$_(e,null,!0),n=$_(t,null,!0),o=r.compare(n);if(o===0)return null;let s=o>0,a=s?r:n,i=s?n:r,E=!!a.prerelease.length;if(!!i.prerelease.length&&!E){if(!i.patch&&!i.minor)return"major";if(i.compareMain(a)===0)return i.minor&&!i.patch?"minor":"patch"}let c=E?"pre":"";return r.major!==n.major?c+"major":r.minor!==n.minor?c+"minor":r.patch!==n.patch?c+"patch":"prerelease"};k_.exports=hA});var K_=m((EL,j_)=>{"use strict";var mA=X(),OA=(e,t)=>new mA(e,t).major;j_.exports=OA});var W_=m((_L,X_)=>{"use strict";var NA=X(),vA=(e,t)=>new NA(e,t).minor;X_.exports=vA});var J_=m((cL,z_)=>{"use strict";var PA=X(),gA=(e,t)=>new PA(e,t).patch;z_.exports=gA});var Z_=m((pL,Q_)=>{"use strict";var LA=it(),CA=(e,t)=>{let r=LA(e,t);return r&&r.prerelease.length?r.prerelease:null};Q_.exports=CA});var Se=m((TL,tc)=>{"use strict";var ec=X(),IA=(e,t,r)=>new ec(e,r).compare(new ec(t,r));tc.exports=IA});var nc=m((uL,rc)=>{"use strict";var MA=Se(),xA=(e,t,r)=>MA(t,e,r);rc.exports=xA});var sc=m((SL,oc)=>{"use strict";var DA=Se(),UA=(e,t)=>DA(e,t,!0);oc.exports=UA});var kn=m((lL,ic)=>{"use strict";var ac=X(),yA=(e,t,r)=>{let n=new ac(e,r),o=new ac(t,r);return n.compare(o)||n.compareBuild(o)};ic.exports=yA});var _c=m((AL,Ec)=>{"use strict";var bA=kn(),VA=(e,t)=>e.sort((r,n)=>bA(r,n,t));Ec.exports=VA});var pc=m((fL,cc)=>{"use strict";var wA=kn(),GA=(e,t)=>e.sort((r,n)=>wA(n,r,t));cc.exports=GA});var hr=m((dL,Tc)=>{"use strict";var BA=Se(),HA=(e,t,r)=>BA(e,t,r)>0;Tc.exports=HA});var qn=m((RL,uc)=>{"use strict";var FA=Se(),YA=(e,t,r)=>FA(e,t,r)<0;uc.exports=YA});var Us=m((hL,Sc)=>{"use strict";var $A=Se(),kA=(e,t,r)=>$A(e,t,r)===0;Sc.exports=kA});var ys=m((mL,lc)=>{"use strict";var qA=Se(),jA=(e,t,r)=>qA(e,t,r)!==0;lc.exports=jA});var jn=m((OL,Ac)=>{"use strict";var KA=Se(),XA=(e,t,r)=>KA(e,t,r)>=0;Ac.exports=XA});var Kn=m((NL,fc)=>{"use strict";var WA=Se(),zA=(e,t,r)=>WA(e,t,r)<=0;fc.exports=zA});var bs=m((vL,dc)=>{"use strict";var JA=Us(),QA=ys(),ZA=hr(),ef=jn(),tf=qn(),rf=Kn(),nf=(e,t,r,n)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return JA(e,r,n);case"!=":return QA(e,r,n);case">":return ZA(e,r,n);case">=":return ef(e,r,n);case"<":return tf(e,r,n);case"<=":return rf(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};dc.exports=nf});var hc=m((PL,Rc)=>{"use strict";var of=X(),sf=it(),{safeRe:Xn,t:Wn}=xt(),af=(e,t)=>{if(e instanceof of)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let r=null;if(!t.rtl)r=e.match(t.includePrerelease?Xn[Wn.COERCEFULL]:Xn[Wn.COERCE]);else{let E=t.includePrerelease?Xn[Wn.COERCERTLFULL]:Xn[Wn.COERCERTL],_;for(;(_=E.exec(e))&&(!r||r.index+r[0].length!==e.length);)(!r||_.index+_[0].length!==r.index+r[0].length)&&(r=_),E.lastIndex=_.index+_[1].length+_[2].length;E.lastIndex=-1}if(r===null)return null;let n=r[2],o=r[3]||"0",s=r[4]||"0",a=t.includePrerelease&&r[5]?`-${r[5]}`:"",i=t.includePrerelease&&r[6]?`+${r[6]}`:"";return sf(`${n}.${o}.${s}${a}${i}`,t)};Rc.exports=af});var Oc=m((gL,mc)=>{"use strict";var Vs=class{constructor(){this.max=1e3,this.map=new Map}get(t){let r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(t,r)}return this}};mc.exports=Vs});var le=m((LL,gc)=>{"use strict";var Ef=/\s+/g,ws=class e{constructor(t,r){if(r=cf(r),t instanceof e)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new e(t.raw,r);if(t instanceof Gs)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t.trim().replace(Ef," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!vc(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&ff(o[0])){this.set=[o];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");let r=this.set[t];for(let n=0;n<r.length;n++)n>0&&(this.formatted+=" "),this.formatted+=r[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(t){let n=((this.options.includePrerelease&&lf)|(this.options.loose&&Af))+":"+t,o=Nc.get(n);if(o)return o;let s=this.options.loose,a=s?Q[W.HYPHENRANGELOOSE]:Q[W.HYPHENRANGE];t=t.replace(a,Lf(this.options.includePrerelease)),x("hyphen replace",t),t=t.replace(Q[W.COMPARATORTRIM],Tf),x("comparator trim",t),t=t.replace(Q[W.TILDETRIM],uf),x("tilde trim",t),t=t.replace(Q[W.CARETTRIM],Sf),x("caret trim",t);let i=t.split(" ").map(T=>df(T,this.options)).join(" ").split(/\s+/).map(T=>gf(T,this.options));s&&(i=i.filter(T=>(x("loose invalid filter",T,this.options),!!T.match(Q[W.COMPARATORLOOSE])))),x("range list",i);let E=new Map,_=i.map(T=>new Gs(T,this.options));for(let T of _){if(vc(T))return[T];E.set(T.value,T)}E.size>1&&E.has("")&&E.delete("");let c=[...E.values()];return Nc.set(n,c),c}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some(n=>Pc(n,r)&&t.set.some(o=>Pc(o,r)&&n.every(s=>o.every(a=>s.intersects(a,r)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new pf(t,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Cf(this.set[r],t,this.options))return!0;return!1}};gc.exports=ws;var _f=Oc(),Nc=new _f,cf=Bn(),Gs=mr(),x=Rr(),pf=X(),{safeRe:Q,t:W,comparatorTrimReplace:Tf,tildeTrimReplace:uf,caretTrimReplace:Sf}=xt(),{FLAG_INCLUDE_PRERELEASE:lf,FLAG_LOOSE:Af}=dr(),vc=e=>e.value==="<0.0.0-0",ff=e=>e.value==="",Pc=(e,t)=>{let r=!0,n=e.slice(),o=n.pop();for(;r&&n.length;)r=n.every(s=>o.intersects(s,t)),o=n.pop();return r},df=(e,t)=>(e=e.replace(Q[W.BUILD],""),x("comp",e,t),e=mf(e,t),x("caret",e),e=Rf(e,t),x("tildes",e),e=Nf(e,t),x("xrange",e),e=Pf(e,t),x("stars",e),e),Z=e=>!e||e.toLowerCase()==="x"||e==="*",Rf=(e,t)=>e.trim().split(/\s+/).map(r=>hf(r,t)).join(" "),hf=(e,t)=>{let r=t.loose?Q[W.TILDELOOSE]:Q[W.TILDE];return e.replace(r,(n,o,s,a,i)=>{x("tilde",e,n,o,s,a,i);let E;return Z(o)?E="":Z(s)?E=`>=${o}.0.0 <${+o+1}.0.0-0`:Z(a)?E=`>=${o}.${s}.0 <${o}.${+s+1}.0-0`:i?(x("replaceTilde pr",i),E=`>=${o}.${s}.${a}-${i} <${o}.${+s+1}.0-0`):E=`>=${o}.${s}.${a} <${o}.${+s+1}.0-0`,x("tilde return",E),E})},mf=(e,t)=>e.trim().split(/\s+/).map(r=>Of(r,t)).join(" "),Of=(e,t)=>{x("caret",e,t);let r=t.loose?Q[W.CARETLOOSE]:Q[W.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(o,s,a,i,E)=>{x("caret",e,o,s,a,i,E);let _;return Z(s)?_="":Z(a)?_=`>=${s}.0.0${n} <${+s+1}.0.0-0`:Z(i)?s==="0"?_=`>=${s}.${a}.0${n} <${s}.${+a+1}.0-0`:_=`>=${s}.${a}.0${n} <${+s+1}.0.0-0`:E?(x("replaceCaret pr",E),s==="0"?a==="0"?_=`>=${s}.${a}.${i}-${E} <${s}.${a}.${+i+1}-0`:_=`>=${s}.${a}.${i}-${E} <${s}.${+a+1}.0-0`:_=`>=${s}.${a}.${i}-${E} <${+s+1}.0.0-0`):(x("no pr"),s==="0"?a==="0"?_=`>=${s}.${a}.${i}${n} <${s}.${a}.${+i+1}-0`:_=`>=${s}.${a}.${i}${n} <${s}.${+a+1}.0-0`:_=`>=${s}.${a}.${i} <${+s+1}.0.0-0`),x("caret return",_),_})},Nf=(e,t)=>(x("replaceXRanges",e,t),e.split(/\s+/).map(r=>vf(r,t)).join(" ")),vf=(e,t)=>{e=e.trim();let r=t.loose?Q[W.XRANGELOOSE]:Q[W.XRANGE];return e.replace(r,(n,o,s,a,i,E)=>{x("xRange",e,n,o,s,a,i,E);let _=Z(s),c=_||Z(a),T=c||Z(i),l=T;return o==="="&&l&&(o=""),E=t.includePrerelease?"-0":"",_?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&l?(c&&(a=0),i=0,o===">"?(o=">=",c?(s=+s+1,a=0,i=0):(a=+a+1,i=0)):o==="<="&&(o="<",c?s=+s+1:a=+a+1),o==="<"&&(E="-0"),n=`${o+s}.${a}.${i}${E}`):c?n=`>=${s}.0.0${E} <${+s+1}.0.0-0`:T&&(n=`>=${s}.${a}.0${E} <${s}.${+a+1}.0-0`),x("xRange return",n),n})},Pf=(e,t)=>(x("replaceStars",e,t),e.trim().replace(Q[W.STAR],"")),gf=(e,t)=>(x("replaceGTE0",e,t),e.trim().replace(Q[t.includePrerelease?W.GTE0PRE:W.GTE0],"")),Lf=e=>(t,r,n,o,s,a,i,E,_,c,T,l)=>(Z(n)?r="":Z(o)?r=`>=${n}.0.0${e?"-0":""}`:Z(s)?r=`>=${n}.${o}.0${e?"-0":""}`:a?r=`>=${r}`:r=`>=${r}${e?"-0":""}`,Z(_)?E="":Z(c)?E=`<${+_+1}.0.0-0`:Z(T)?E=`<${_}.${+c+1}.0-0`:l?E=`<=${_}.${c}.${T}-${l}`:e?E=`<${_}.${c}.${+T+1}-0`:E=`<=${E}`,`${r} ${E}`.trim()),Cf=(e,t,r)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let n=0;n<e.length;n++)if(x(e[n].semver),e[n].semver!==Gs.ANY&&e[n].semver.prerelease.length>0){let o=e[n].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}});var mr=m((CL,Dc)=>{"use strict";var Or=Symbol("SemVer ANY"),Fs=class e{static get ANY(){return Or}constructor(t,r){if(r=Lc(r),t instanceof e){if(t.loose===!!r.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),Hs("comparator",t,r),this.options=r,this.loose=!!r.loose,this.parse(t),this.semver===Or?this.value="":this.value=this.operator+this.semver.version,Hs("comp",this)}parse(t){let r=this.options.loose?Cc[Ic.COMPARATORLOOSE]:Cc[Ic.COMPARATOR],n=t.match(r);if(!n)throw new TypeError(`Invalid comparator: ${t}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Mc(n[2],this.options.loose):this.semver=Or}toString(){return this.value}test(t){if(Hs("Comparator.test",t,this.options.loose),this.semver===Or||t===Or)return!0;if(typeof t=="string")try{t=new Mc(t,this.options)}catch{return!1}return Bs(t,this.operator,this.semver,this.options)}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new xc(t.value,r).test(this.value):t.operator===""?t.value===""?!0:new xc(this.value,r).test(t.semver):(r=Lc(r),r.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||Bs(this.semver,"<",t.semver,r)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||Bs(this.semver,">",t.semver,r)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};Dc.exports=Fs;var Lc=Bn(),{safeRe:Cc,t:Ic}=xt(),Bs=bs(),Hs=Rr(),Mc=X(),xc=le()});var Nr=m((IL,Uc)=>{"use strict";var If=le(),Mf=(e,t,r)=>{try{t=new If(t,r)}catch{return!1}return t.test(e)};Uc.exports=Mf});var bc=m((ML,yc)=>{"use strict";var xf=le(),Df=(e,t)=>new xf(e,t).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));yc.exports=Df});var wc=m((xL,Vc)=>{"use strict";var Uf=X(),yf=le(),bf=(e,t,r)=>{let n=null,o=null,s=null;try{s=new yf(t,r)}catch{return null}return e.forEach(a=>{s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new Uf(n,r))}),n};Vc.exports=bf});var Bc=m((DL,Gc)=>{"use strict";var Vf=X(),wf=le(),Gf=(e,t,r)=>{let n=null,o=null,s=null;try{s=new wf(t,r)}catch{return null}return e.forEach(a=>{s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new Vf(n,r))}),n};Gc.exports=Gf});var Yc=m((UL,Fc)=>{"use strict";var Ys=X(),Bf=le(),Hc=hr(),Hf=(e,t)=>{e=new Bf(e,t);let r=new Ys("0.0.0");if(e.test(r)||(r=new Ys("0.0.0-0"),e.test(r)))return r;r=null;for(let n=0;n<e.set.length;++n){let o=e.set[n],s=null;o.forEach(a=>{let i=new Ys(a.semver.version);switch(a.operator){case">":i.prerelease.length===0?i.patch++:i.prerelease.push(0),i.raw=i.format();case"":case">=":(!s||Hc(i,s))&&(s=i);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!r||Hc(r,s))&&(r=s)}return r&&e.test(r)?r:null};Fc.exports=Hf});var kc=m((yL,$c)=>{"use strict";var Ff=le(),Yf=(e,t)=>{try{return new Ff(e,t).range||"*"}catch{return null}};$c.exports=Yf});var zn=m((bL,Xc)=>{"use strict";var $f=X(),Kc=mr(),{ANY:kf}=Kc,qf=le(),jf=Nr(),qc=hr(),jc=qn(),Kf=Kn(),Xf=jn(),Wf=(e,t,r,n)=>{e=new $f(e,n),t=new qf(t,n);let o,s,a,i,E;switch(r){case">":o=qc,s=Kf,a=jc,i=">",E=">=";break;case"<":o=jc,s=Xf,a=qc,i="<",E="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(jf(e,t,n))return!1;for(let _=0;_<t.set.length;++_){let c=t.set[_],T=null,l=null;if(c.forEach(f=>{f.semver===kf&&(f=new Kc(">=0.0.0")),T=T||f,l=l||f,o(f.semver,T.semver,n)?T=f:a(f.semver,l.semver,n)&&(l=f)}),T.operator===i||T.operator===E||(!l.operator||l.operator===i)&&s(e,l.semver))return!1;if(l.operator===E&&a(e,l.semver))return!1}return!0};Xc.exports=Wf});var zc=m((VL,Wc)=>{"use strict";var zf=zn(),Jf=(e,t,r)=>zf(e,t,">",r);Wc.exports=Jf});var Qc=m((wL,Jc)=>{"use strict";var Qf=zn(),Zf=(e,t,r)=>Qf(e,t,"<",r);Jc.exports=Zf});var tp=m((GL,ep)=>{"use strict";var Zc=le(),ed=(e,t,r)=>(e=new Zc(e,r),t=new Zc(t,r),e.intersects(t,r));ep.exports=ed});var np=m((BL,rp)=>{"use strict";var td=Nr(),rd=Se();rp.exports=(e,t,r)=>{let n=[],o=null,s=null,a=e.sort((c,T)=>rd(c,T,r));for(let c of a)td(c,t,r)?(s=c,o||(o=c)):(s&&n.push([o,s]),s=null,o=null);o&&n.push([o,null]);let i=[];for(let[c,T]of n)c===T?i.push(c):!T&&c===a[0]?i.push("*"):T?c===a[0]?i.push(`<=${T}`):i.push(`${c} - ${T}`):i.push(`>=${c}`);let E=i.join(" || "),_=typeof t.raw=="string"?t.raw:String(t);return E.length<_.length?E:t}});var _p=m((HL,Ep)=>{"use strict";var op=le(),ks=mr(),{ANY:$s}=ks,vr=Nr(),qs=Se(),nd=(e,t,r={})=>{if(e===t)return!0;e=new op(e,r),t=new op(t,r);let n=!1;e:for(let o of e.set){for(let s of t.set){let a=sd(o,s,r);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},od=[new ks(">=0.0.0-0")],sp=[new ks(">=0.0.0")],sd=(e,t,r)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===$s){if(t.length===1&&t[0].semver===$s)return!0;r.includePrerelease?e=od:e=sp}if(t.length===1&&t[0].semver===$s){if(r.includePrerelease)return!0;t=sp}let n=new Set,o,s;for(let f of e)f.operator===">"||f.operator===">="?o=ap(o,f,r):f.operator==="<"||f.operator==="<="?s=ip(s,f,r):n.add(f.semver);if(n.size>1)return null;let a;if(o&&s){if(a=qs(o.semver,s.semver,r),a>0)return null;if(a===0&&(o.operator!==">="||s.operator!=="<="))return null}for(let f of n){if(o&&!vr(f,String(o),r)||s&&!vr(f,String(s),r))return null;for(let C of t)if(!vr(f,String(C),r))return!1;return!0}let i,E,_,c,T=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1,l=o&&!r.includePrerelease&&o.semver.prerelease.length?o.semver:!1;T&&T.prerelease.length===1&&s.operator==="<"&&T.prerelease[0]===0&&(T=!1);for(let f of t){if(c=c||f.operator===">"||f.operator===">=",_=_||f.operator==="<"||f.operator==="<=",o){if(l&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===l.major&&f.semver.minor===l.minor&&f.semver.patch===l.patch&&(l=!1),f.operator===">"||f.operator===">="){if(i=ap(o,f,r),i===f&&i!==o)return!1}else if(o.operator===">="&&!vr(o.semver,String(f),r))return!1}if(s){if(T&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===T.major&&f.semver.minor===T.minor&&f.semver.patch===T.patch&&(T=!1),f.operator==="<"||f.operator==="<="){if(E=ip(s,f,r),E===f&&E!==s)return!1}else if(s.operator==="<="&&!vr(s.semver,String(f),r))return!1}if(!f.operator&&(s||o)&&a!==0)return!1}return!(o&&_&&!s&&a!==0||s&&c&&!o&&a!==0||l||T)},ap=(e,t,r)=>{if(!e)return t;let n=qs(e.semver,t.semver,r);return n>0?e:n<0||t.operator===">"&&e.operator===">="?t:e},ip=(e,t,r)=>{if(!e)return t;let n=qs(e.semver,t.semver,r);return n<0?e:n>0||t.operator==="<"&&e.operator==="<="?t:e};Ep.exports=nd});var up=m((FL,Tp)=>{"use strict";var js=xt(),cp=dr(),ad=X(),pp=Ms(),id=it(),Ed=w_(),_d=B_(),cd=Y_(),pd=q_(),Td=K_(),ud=W_(),Sd=J_(),ld=Z_(),Ad=Se(),fd=nc(),dd=sc(),Rd=kn(),hd=_c(),md=pc(),Od=hr(),Nd=qn(),vd=Us(),Pd=ys(),gd=jn(),Ld=Kn(),Cd=bs(),Id=hc(),Md=mr(),xd=le(),Dd=Nr(),Ud=bc(),yd=wc(),bd=Bc(),Vd=Yc(),wd=kc(),Gd=zn(),Bd=zc(),Hd=Qc(),Fd=tp(),Yd=np(),$d=_p();Tp.exports={parse:id,valid:Ed,clean:_d,inc:cd,diff:pd,major:Td,minor:ud,patch:Sd,prerelease:ld,compare:Ad,rcompare:fd,compareLoose:dd,compareBuild:Rd,sort:hd,rsort:md,gt:Od,lt:Nd,eq:vd,neq:Pd,gte:gd,lte:Ld,cmp:Cd,coerce:Id,Comparator:Md,Range:xd,satisfies:Dd,toComparators:Ud,maxSatisfying:yd,minSatisfying:bd,minVersion:Vd,validRange:wd,outside:Gd,gtr:Bd,ltr:Hd,intersects:Fd,simplifyRange:Yd,subset:$d,SemVer:ad,re:js.re,src:js.src,tokens:js.t,SEMVER_SPEC_VERSION:cp.SEMVER_SPEC_VERSION,RELEASE_TYPES:cp.RELEASE_TYPES,compareIdentifiers:pp.compareIdentifiers,rcompareIdentifiers:pp.rcompareIdentifiers}});function qd(e){var t=decodeURIComponent(e).split(":");if(t.length!==4)return null;var r=lp(t,4),n=r[0],o=r[1],s=r[3],a=n.padStart(32,"0"),i=o.padStart(16,"0"),E=kd.test(s)?parseInt(s,16)&1:1;return{traceId:a,spanId:i,isRemote:!0,traceFlags:E}}var Sp,lp,Ks,Jn,Ap,kd,fp=p(()=>{g();B();Sp=function(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},lp=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(i){a={error:i}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},Ks="uber-trace-id",Jn="uberctx",Ap=(function(){function e(t){typeof t=="string"?(this._jaegerTraceHeader=t,this._jaegerBaggageHeaderPrefix=Jn):(this._jaegerTraceHeader=(t==null?void 0:t.customTraceHeader)||Ks,this._jaegerBaggageHeaderPrefix=(t==null?void 0:t.customBaggageHeaderPrefix)||Jn)}return e.prototype.inject=function(t,r,n){var o,s,a=P.getSpanContext(t),i=K.getBaggage(t);if(a&&z(t)===!1){var E="0"+(a.traceFlags||L.NONE).toString(16);n.set(r,this._jaegerTraceHeader,a.traceId+":"+a.spanId+":0:"+E)}if(i)try{for(var _=Sp(i.getAllEntries()),c=_.next();!c.done;c=_.next()){var T=lp(c.value,2),l=T[0],f=T[1];n.set(r,this._jaegerBaggageHeaderPrefix+"-"+l,encodeURIComponent(f.value))}}catch(C){o={error:C}}finally{try{c&&!c.done&&(s=_.return)&&s.call(_)}finally{if(o)throw o.error}}},e.prototype.extract=function(t,r,n){var o,s,a=this,i,E=n.get(r,this._jaegerTraceHeader),_=Array.isArray(E)?E[0]:E,c=n.keys(r).filter(function(re){return re.startsWith(a._jaegerBaggageHeaderPrefix+"-")}).map(function(re){var pe=n.get(r,re);return{key:re.substring(a._jaegerBaggageHeaderPrefix.length+1),value:Array.isArray(pe)?pe[0]:pe}}),T=t;if(typeof _=="string"){var l=qd(_);l&&(T=P.setSpanContext(T,l))}if(c.length===0)return T;var f=(i=K.getBaggage(t))!==null&&i!==void 0?i:K.createBaggage();try{for(var C=Sp(c),V=C.next();!V.done;V=C.next()){var q=V.value;q.value!==void 0&&(f=f.setEntry(q.key,{value:decodeURIComponent(q.value)}))}}catch(re){o={error:re}}finally{try{V&&!V.done&&(s=C.return)&&s.call(C)}finally{if(o)throw o.error}}return T=K.setBaggage(T,f),T},e.prototype.fields=function(){return[this._jaegerTraceHeader]},e})(),kd=/^[0-9a-f]{1,2}$/i});var dp={};Je(dp,{JaegerPropagator:()=>Ap,UBER_BAGGAGE_HEADER_PREFIX:()=>Jn,UBER_TRACE_ID_HEADER:()=>Ks});var Rp=p(()=>{fp()});var Op=m(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.NodeTracerProvider=void 0;var hp=n_(),Qn=(__(),Tt(E_)),mp=(Ls(),Tt(gs)),jd=up(),Kd=(Rp(),Tt(dp)),Zn=class extends mp.BasicTracerProvider{constructor(t={}){super(t)}register(t={}){if(t.contextManager===void 0){let r=jd.gte(process.version,"14.8.0")?hp.AsyncLocalStorageContextManager:hp.AsyncHooksContextManager;t.contextManager=new r,t.contextManager.enable()}super.register(t)}};eo.NodeTracerProvider=Zn;Zn._registeredPropagators=new Map([...mp.BasicTracerProvider._registeredPropagators,["b3",()=>new Qn.B3Propagator({injectEncoding:Qn.B3InjectEncoding.SINGLE_HEADER})],["b3multi",()=>new Qn.B3Propagator({injectEncoding:Qn.B3InjectEncoding.MULTI_HEADER})],["jaeger",()=>new Kd.JaegerPropagator]])});var Xs=m(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.Tracer=v.TraceIdRatioBasedSampler=v.Span=v.SimpleSpanProcessor=v.SamplingDecision=v.RandomIdGenerator=v.ParentBasedSampler=v.NoopSpanProcessor=v.InMemorySpanExporter=v.ForceFlushState=v.ConsoleSpanExporter=v.BatchSpanProcessor=v.BasicTracerProvider=v.AlwaysOnSampler=v.AlwaysOffSampler=v.NodeTracerProvider=void 0;var Xd=Op();Object.defineProperty(v,"NodeTracerProvider",{enumerable:!0,get:function(){return Xd.NodeTracerProvider}});var ee=(Ls(),Tt(gs));Object.defineProperty(v,"AlwaysOffSampler",{enumerable:!0,get:function(){return ee.AlwaysOffSampler}});Object.defineProperty(v,"AlwaysOnSampler",{enumerable:!0,get:function(){return ee.AlwaysOnSampler}});Object.defineProperty(v,"BasicTracerProvider",{enumerable:!0,get:function(){return ee.BasicTracerProvider}});Object.defineProperty(v,"BatchSpanProcessor",{enumerable:!0,get:function(){return ee.BatchSpanProcessor}});Object.defineProperty(v,"ConsoleSpanExporter",{enumerable:!0,get:function(){return ee.ConsoleSpanExporter}});Object.defineProperty(v,"ForceFlushState",{enumerable:!0,get:function(){return ee.ForceFlushState}});Object.defineProperty(v,"InMemorySpanExporter",{enumerable:!0,get:function(){return ee.InMemorySpanExporter}});Object.defineProperty(v,"NoopSpanProcessor",{enumerable:!0,get:function(){return ee.NoopSpanProcessor}});Object.defineProperty(v,"ParentBasedSampler",{enumerable:!0,get:function(){return ee.ParentBasedSampler}});Object.defineProperty(v,"RandomIdGenerator",{enumerable:!0,get:function(){return ee.RandomIdGenerator}});Object.defineProperty(v,"SamplingDecision",{enumerable:!0,get:function(){return ee.SamplingDecision}});Object.defineProperty(v,"SimpleSpanProcessor",{enumerable:!0,get:function(){return ee.SimpleSpanProcessor}});Object.defineProperty(v,"Span",{enumerable:!0,get:function(){return ee.Span}});Object.defineProperty(v,"TraceIdRatioBasedSampler",{enumerable:!0,get:function(){return ee.TraceIdRatioBasedSampler}});Object.defineProperty(v,"Tracer",{enumerable:!0,get:function(){return ee.Tracer}})});var Eu={};Je(Eu,{BatchSpanProcessor:()=>No.BatchSpanProcessor,SimpleSpanProcessor:()=>No.SimpleSpanProcessor,SpanKind:()=>oe,SpanStatusCode:()=>F,W3CTraceContextPropagator:()=>Ge,context:()=>y,propagation:()=>K,trace:()=>P});var No,_u=p(()=>{g();B();No=xa(Xs(),1)});var cu={};Je(cu,{FetchInstrumentation:()=>zR});import*as vo from"diagnostics_channel";var zR,pu=p(()=>{g();Jr();zR=class{constructor(e={}){this.instrumentationName="@netlify/otel/instrumentation-fetch",this.instrumentationVersion="1.0.0",this._recordFromReq=new WeakMap,this.config=e,this._channelSubs=[]}getConfig(){return this.config}setConfig(){}setMeterProvider(){}setTracerProvider(e){this.provider=e}getTracerProvider(){return this.provider}annotateFromRequest(e,t){var o,s;let r=((s=(o=this.config).getRequestAttributes)==null?void 0:s.call(o,t))??{},n=new URL(t.path,t.origin);e.setAttributes({...r,"http.request.method":t.method,"url.full":n.href,"url.host":n.host,"url.scheme":n.protocol.slice(0,-1),"server.address":n.hostname,"server.port":n.port,...this.prepareHeaders("request",t.headers)})}annotateFromResponse(e,t){var n,o;let r=((o=(n=this.config).getResponseAttributes)==null?void 0:o.call(n,t))??{};e.setAttributes({...r,"http.response.status_code":t.statusCode,...this.prepareHeaders("response",t.headers)}),e.setStatus({code:t.statusCode>=400?F.ERROR:F.UNSET})}prepareHeaders(e,t){if(!Array.isArray(t))return{};if(this.config.skipHeaders===!0)return{};let r=["*","/.*/"],n=this.config.skipHeaders??[],o=this.config.redactHeaders??[],s=n.some(i=>r.includes(i.toString())),a={};if(s)return a;for(let i=0;i+1<t.length;i=i+2){let E=t[i],_=t[i+1];if(typeof E!="string"&&!Buffer.isBuffer(E)||typeof _!="string"&&!Buffer.isBuffer(_))continue;let c=E.toString().toLowerCase();if(n.some(l=>typeof l=="string"?l==c:l.test(c)))continue;let T=`http.${e}.header.${c}`;o===!0||o.some(l=>typeof l=="string"?l==c:l.test(c))?a[T]="REDACTED":a[T]=_.toString()}return a}getRequestMethod(e){return["HEAD","GET","POST","PUT","PATCH","DELETE"].includes(e.toUpperCase())?e.toUpperCase():"_OTHER"}getTracer(){if(!this.provider)return;let e=this.provider.getTracer(this.instrumentationName,this.instrumentationVersion);return e instanceof Ce?e:new Ce(e)}enable(){this._channelSubs.length>0||(this.subscribe("undici:request:create",this.onRequestCreate.bind(this)),this.subscribe("undici:request:headers",this.onRequestHeaders.bind(this)),this.subscribe("undici:request:trailers",this.onRequestEnd.bind(this)),this.subscribe("undici:request:error",this.onRequestError.bind(this)))}subscribe(e,t){vo.subscribe(e,t);let r=()=>vo.unsubscribe(e,t);this._channelSubs.push({name:e,unsubscribe:r})}disable(){this._channelSubs.forEach(e=>{e.unsubscribe()}),this._channelSubs.length=0}onRequestCreate({request:e}){var t;try{let r=this.getTracer(),n=new URL(e.path,e.origin);if(!r||e.method==="CONNECT"||(t=this.config.skipURLs)!=null&&t.some(s=>typeof s=="string"?n.href.startsWith(s):s.test(n.href)))return;let o=r.startSpan(this.getRequestMethod(e.method),{kind:oe.CLIENT},y.active());this.annotateFromRequest(o,e),this._recordFromReq.set(e,o)}catch{}}onRequestHeaders({request:e,response:t}){try{let r=this._recordFromReq.get(e);if(!r)return;this.annotateFromResponse(r,t)}catch{}}onRequestError({request:e,error:t}){try{let r=this._recordFromReq.get(e);if(!r)return;r.recordException(t),r.setStatus({code:F.ERROR,message:t.message}),r.end(),this._recordFromReq.delete(e)}catch{}}onRequestEnd({request:e}){try{let t=this._recordFromReq.get(e);if(!t)return;t.end(),this._recordFromReq.delete(e)}catch{}}}});var Tu={};Je(Tu,{HttpInstrumentation:()=>JR});import*as Po from"diagnostics_channel";var JR,uu=p(()=>{g();Jr();JR=class{constructor(e={}){this.instrumentationName="@netlify/otel/instrumentation-http",this.instrumentationVersion="1.0.0",this._recordFromReq=new WeakMap,this.config=e,this._channelSubs=[]}getConfig(){return this.config}setConfig(){}setMeterProvider(){}setTracerProvider(e){this.provider=e}getTracerProvider(){return this.provider}annotateFromRequest(e,t){var o,s;let r=((s=(o=this.config).getRequestAttributes)==null?void 0:s.call(o,t))??{},n=new URL(t.path,`${t.protocol}//${t.host}`);e.setAttributes({...r,"http.request.method":t.method,"url.full":n.href,"url.host":n.host,"url.scheme":n.protocol.slice(0,-1),"server.address":n.hostname,...this.prepareHeaders("request",t.getHeaders())})}annotateFromResponse(e,t){var n,o;let r=((o=(n=this.config).getResponseAttributes)==null?void 0:o.call(n,t))??{};e.setAttributes({...r,"http.response.status_code":t.statusCode,...this.prepareHeaders("response",t.headers)}),e.setStatus({code:t.statusCode&&t.statusCode>=400?F.ERROR:F.UNSET})}prepareHeaders(e,t){if(this.config.skipHeaders===!0)return{};let r=["*","/.*/"],n=this.config.skipHeaders??[],o=this.config.redactHeaders??[],s=n.some(E=>r.includes(E.toString())),a={};if(s)return a;let i=Object.entries(t);for(let[E,_]of i){if(n.some(T=>typeof T=="string"?T==E:T.test(E)))continue;let c=`http.${e}.header.${E}`;o===!0||o.some(T=>typeof T=="string"?T==E:T.test(E))?a[c]="REDACTED":a[c]=_}return a}getRequestMethod(e){return["HEAD","GET","POST","PUT","PATCH","DELETE"].includes(e.toUpperCase())?e.toUpperCase():"_OTHER"}getTracer(){if(!this.provider)return;let e=this.provider.getTracer(this.instrumentationName,this.instrumentationVersion);return e instanceof Ce?e:new Ce(e)}enable(){this._channelSubs.length>0||(this.subscribe("http.client.request.start",this.onRequest.bind(this)),this.subscribe("http.client.response.finish",this.onResponse.bind(this)),this.subscribe("http.client.request.error",this.onError.bind(this)))}disable(){this._channelSubs.forEach(e=>{e.unsubscribe()}),this._channelSubs.length=0}onRequest({request:e}){var t;try{let r=this.getTracer(),n=new URL(e.path,`${e.protocol}//${e.host}`);if(!r||(t=this.config.skipURLs)!=null&&t.some(s=>typeof s=="string"?n.href.startsWith(s):s.test(n.href)))return;let o=r.startSpan(this.getRequestMethod(e.method),{kind:oe.CLIENT},y.active());this.annotateFromRequest(o,e),this._recordFromReq.set(e,o)}catch{}}onResponse({request:e,response:t}){try{let r=this._recordFromReq.get(e);if(!r)return;this.annotateFromResponse(r,t),r.end(),this._recordFromReq.delete(e)}catch{}}onError({request:e,error:t}){try{let r=this._recordFromReq.get(e);if(!r)return;r.recordException(t),r.setStatus({code:F.ERROR,message:t.name}),r.end(),this._recordFromReq.delete(e)}catch{}}subscribe(e,t){Po.subscribe(e,t);let r=()=>Po.unsubscribe(e,t);this._channelSubs.push({name:e,unsubscribe:r})}}});import{fileURLToPath as Eh}from"url";import{pipeline as QR,Readable as ZR}from"stream";import{promisify as eh}from"util";g();Jr();is();import zd from"process";g();var ur=class{emit(t){}},zE=new ur;var Es=class{getLogger(t,r,n){return new ur}},dn=new Es;var Rn=class{constructor(t,r,n,o){this._provider=t,this.name=r,this.version=n,this.options=o}emit(t){this._getLogger().emit(t)}_getLogger(){if(this._delegate)return this._delegate;let t=this._provider.getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):zE}};var Sr=class{getLogger(t,r,n){var o;return(o=this.getDelegateLogger(t,r,n))!==null&&o!==void 0?o:new Rn(this,t,r,n)}getDelegate(){var t;return(t=this._delegate)!==null&&t!==void 0?t:dn}setDelegate(t){this._delegate=t}getDelegateLogger(t,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getLogger(t,r,n)}};var hn=typeof globalThis=="object"?globalThis:global;var lr=Symbol.for("io.opentelemetry.js.api.logs"),ft=hn;function JE(e,t,r){return n=>n===e?t:r}var _s=1;var mn=class e{constructor(){this._proxyLoggerProvider=new Sr}static getInstance(){return this._instance||(this._instance=new e),this._instance}setGlobalLoggerProvider(t){return ft[lr]?this.getLoggerProvider():(ft[lr]=JE(_s,t,dn),this._proxyLoggerProvider.setDelegate(t),t)}getLoggerProvider(){var t,r;return(r=(t=ft[lr])===null||t===void 0?void 0:t.call(ft,_s))!==null&&r!==void 0?r:this._proxyLoggerProvider}getLogger(t,r,n){return this.getLoggerProvider().getLogger(t,r,n)}disable(){delete ft[lr],this._proxyLoggerProvider=new Sr}};var QE=mn.getInstance();function ZE(e,t,r,n){for(let o=0,s=e.length;o<s;o++){let a=e[o];t&&a.setTracerProvider(t),r&&a.setMeterProvider(r),n&&a.setLoggerProvider&&a.setLoggerProvider(n),a.getConfig().enabled||a.enable()}}function e_(e){e.forEach(t=>t.disable())}function cs(e){var s;let t=e.tracerProvider||P.getTracerProvider(),r=e.meterProvider||rr.getMeterProvider(),n=e.loggerProvider||QE.getLoggerProvider(),o=((s=e.instrumentations)==null?void 0:s.flat())??[];return ZE(o,t,r,n),()=>{e_(o)}}B();var no=xa(Xs(),1);g();B();var gp=e=>{throw TypeError(e)},Qs=(e,t,r)=>t.has(e)||gp("Cannot "+r),ro=(e,t,r)=>(Qs(e,t,"read from private field"),r?r.call(e):t.get(e)),Ws=(e,t,r)=>t.has(e)?gp("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Np=(e,t,r,n)=>(Qs(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Wd=(e,t,r)=>(Qs(e,t,"access private method"),r),vp="__netlify__getTracer",Jd="__netlify__shutdownTracers",Qd="__nfOTLPTrace",Pr,gr,Js,Lp,Zd=class{constructor(){Ws(this,Js),Ws(this,Pr),Ws(this,gr),Np(this,Pr,new Be(Wd(this,Js,Lp),this)),Np(this,gr,O.createComponentLogger({namespace:"netlify-span-exporter"}))}export(e,t){if(ro(this,gr).debug(`export ${e.length.toString()} spans`),ro(this,Pr).isCalled){t({code:J.FAILED,error:new Error("Exporter has been shutdown")});return}console.log(Qd,JSON.stringify(eR(e))),t({code:J.SUCCESS})}shutdown(){return ro(this,Pr).call()}};Pr=new WeakMap;gr=new WeakMap;Js=new WeakSet;Lp=function(){return ro(this,gr).debug("Shutting down"),Promise.resolve()};function eR(e){return{resourceSpans:e.map(t=>{let r=t.spanContext();return{resource:{attributes:to(t.resource.attributes),droppedAttributesCount:t.droppedAttributesCount},scopeSpans:[{scope:{name:t.instrumentationLibrary.name,version:t.instrumentationLibrary.version},spans:[{traceId:r.traceId,spanId:r.spanId,parentSpanId:t.parentSpanId,name:t.name,kind:t.kind||oe.SERVER,startTimeUnixNano:zs(t.startTime),endTimeUnixNano:zs(t.endTime),attributes:to(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(n=>({name:n.name,timeUnixNano:zs(n.time),attributes:to(n.attributes??{}),droppedAttributesCount:n.droppedAttributesCount??0})),droppedEventsCount:t.droppedEventsCount,status:{code:t.status.code,message:t.status.message},links:t.links.map(n=>({spanId:n.context.spanId,traceId:n.context.traceId,attributes:to(n.attributes??{}),droppedAttributesCount:n.droppedAttributesCount??0})),droppedLinksCount:t.droppedLinksCount}]}]}})}}function to(e){return Object.keys(e).map(t=>Cp(t,e[t]))}function Cp(e,t){return{key:e,value:Ip(t)}}function Ip(e){let t=typeof e;return t==="string"?{stringValue:e}:t==="number"?Number.isInteger(e)?{intValue:e}:{doubleValue:e}:t==="boolean"?{boolValue:e}:e instanceof Uint8Array?{bytesValue:e}:Array.isArray(e)?{arrayValue:{values:e.map(Ip)}}:t==="object"&&e!=null?{kvlistValue:{values:Object.entries(e).map(([r,n])=>Cp(r,n))}}:{}}function zs(e){let t=BigInt(1e9);return(BigInt(Math.trunc(e[0]))*t+BigInt(Math.trunc(e[1]))).toString()}var Pp={name:"@netlify/otel",version:"5.1.1",type:"module",engines:{node:"^18.14.0 || >=20.6.1"},main:"./dist/main.cjs",module:"./dist/main.js",types:"./dist/main.d.ts",exports:{".":{require:{types:"./dist/main.d.cts",default:"./dist/main.cjs"},import:{types:"./dist/main.d.ts",default:"./dist/main.js"},default:{types:"./dist/main.d.ts",default:"./dist/main.js"}},"./package.json":"./package.json","./bootstrap":{require:{types:"./dist/bootstrap/main.d.cts",default:"./dist/bootstrap/main.cjs"},import:{types:"./dist/bootstrap/main.d.ts",default:"./dist/bootstrap/main.js"},default:{types:"./dist/bootstrap/main.d.ts",default:"./dist/bootstrap/main.js"}},"./exporter-netlify":{require:{types:"./dist/exporters/netlify.d.cts",default:"./dist/exporters/netlify.cjs"},import:{types:"./dist/exporters/netlify.d.ts",default:"./dist/exporters/netlify.js"},default:{types:"./dist/exporters/netlify.d.ts",default:"./dist/exporters/netlify.js"}},"./instrumentation-fetch":{require:{types:"./dist/instrumentations/fetch.d.cts",default:"./dist/instrumentations/fetch.cjs"},import:{types:"./dist/instrumentations/fetch.d.ts",default:"./dist/instrumentations/fetch.js"},default:{types:"./dist/instrumentations/fetch.d.ts",default:"./dist/instrumentations/fetch.js"}},"./instrumentation-http":{require:{types:"./dist/instrumentations/http.d.cts",default:"./dist/instrumentations/http.cjs"},import:{types:"./dist/instrumentations/http.d.ts",default:"./dist/instrumentations/http.js"},default:{types:"./dist/instrumentations/http.d.ts",default:"./dist/instrumentations/http.js"}},"./opentelemetry":{require:{types:"./dist/opentelemetry.d.cts",default:"./dist/opentelemetry.cjs"},import:{types:"./dist/opentelemetry.d.ts",default:"./dist/opentelemetry.js"},default:{types:"./dist/opentelemetry.d.ts",default:"./dist/opentelemetry.js"}}},files:["dist/**/*"],scripts:{build:"tsup-node",dev:"tsup-node --watch",prepack:"npm run build",test:"run-s build test:ci","test:dev":"run-s build test:dev:*","test:ci":"run-s build test:ci:*","test:dev:vitest":"vitest","test:dev:vitest:watch":"vitest watch","test:ci:vitest":"vitest run",publint:"npx -y publint --strict"},keywords:["netlify","cdn"],license:"MIT",repository:{type:"git",url:"https://github.com/netlify/primitives.git",directory:"packages/otel"},bugs:{url:"https://github.com/netlify/primitives/issues"},author:"Netlify Inc.",devDependencies:{"@netlify/dev-utils":"^4.3.3",msw:"^2.10.5","npm-run-all2":"^7.0.2",tsup:"^8.0.0",vitest:"^3.0.0"},dependencies:{"@opentelemetry/api":"1.9.0","@opentelemetry/core":"1.30.1","@opentelemetry/instrumentation":"^0.203.0","@opentelemetry/resources":"1.30.1","@opentelemetry/sdk-trace-node":"1.30.1"}},Mp=e=>{if(Object.prototype.hasOwnProperty.call(globalThis,vp))return;let t=zd.version.slice(1),r=new Ie({"service.name":e.serviceName,"service.version":e.serviceVersion,"process.runtime.name":"nodejs","process.runtime.version":t,"deployment.environment":e.deploymentEnvironment,"http.url":e.siteUrl,"netlify.site.id":e.siteId,"netlify.site.name":e.siteName}),n=e.spanProcessors??[tR()],o=new no.NodeTracerProvider({resource:r,spanProcessors:n});o.register({propagator:new Ge});let s=e.instrumentations??[];cs({instrumentations:s,tracerProvider:o}),Object.defineProperty(globalThis,vp,{enumerable:!1,configurable:!0,writable:!1,value:function(i,E){return i?new Ce(P.getTracer(i,E)):new Ce(P.getTracer(Pp.name,Pp.version))}}),Object.defineProperty(globalThis,Jd,{enumerable:!1,configurable:!0,writable:!1,value:async()=>await o.shutdown()})},tR=()=>new no.SimpleSpanProcessor(new Zd);var oC=globalThis.Buffer?e=>Buffer.from(e,"base64").toString():e=>atob(e),xp=globalThis.Buffer?e=>Buffer.from(e).toString("base64"):e=>btoa(e);var yp=e=>{throw TypeError(e)},bp=(e,t,r)=>t.has(e)||yp("Cannot "+r),se=(e,t,r)=>(bp(e,t,"read from private field"),r?r.call(e):t.get(e)),Cr=(e,t,r)=>t.has(e)?yp("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ir=(e,t,r,n)=>(bp(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),io=(e=>(e.Delete="delete",e.Read="read",e.Write="write",e))(io||{}),rR={invalid_vary:"Responses must not use unsupported directives of the `Netlify-Vary` header (https://ntl.fyi/cache_api_invalid_vary).",no_cache:"Responses must not set cache control headers with the `private`, `no-cache` or `no-store` directives (https://ntl.fyi/cache_api_no_cache).",low_ttl:"Responses must have a cache control header with a `max-age` or `s-maxage` directive (https://ntl.fyi/cache_api_low_ttl).",no_directive:"Responses must have a cache control header with caching directives (https://ntl.fyi/cache_api_no_directive).",no_ttl:"Responses must have a cache control header with a `max-age` or `s-maxage` directive (https://ntl.fyi/cache_api_no_ttl).",no_status:"Responses must specify a status code (https://ntl.fyi/cache_api_no_status).",invalid_directive:"Responses must have a cache control header with caching directives (https://ntl.fyi/cache_api_invalid_directive).",status:"Responses must have a status code between 200 and 299 (https://ntl.fyi/cache_api_status)."},nR="The server has returned an unexpected error (https://ntl.fyi/cache_api_error).",oR="netlify-programmable-error",sR="netlify-programmable-headers",aR="netlify-programmable-status",iR="netlify-programmable-store",ER="netlify-forwarded-host",_R="user-agent",Dp=new Set(["http:","https:"]),cR=new Set(["cookie","content-encoding","content-length"]),oo=Symbol("getInternalHeaders"),Up=Symbol("serializeResourceHeaders"),Dt,so,Lr,pR=class{constructor({getContext:e,name:t,userAgent:r}){Cr(this,Dt),Cr(this,so),Cr(this,Lr),Ir(this,Dt,e),Ir(this,so,t),Ir(this,Lr,r)}[oo](e){let{host:t,token:r}=e,n={Authorization:`Bearer ${r}`,[iR]:se(this,so)};return t&&(n[ER]=t),se(this,Lr)&&(n[_R]=se(this,Lr)),n}[Up](e){let t={};return e.forEach((r,n)=>{cR.has(n)||(n==="set-cookie"?(t[n]=t[n]||[],t[n].push(r)):t[n]=r.split(","))}),xp(JSON.stringify(t))}async add(e){await this.put(new Request(e),await fetch(e))}async addAll(e){await Promise.allSettled(e.map(t=>this.add(t)))}async delete(e){let t=se(this,Dt).call(this,{operation:"delete"});if(t){let r=Zs(e);await fetch(`${t.url}/${ea(r)}`,{headers:this[oo](t),method:"DELETE"})}return!0}async keys(e){return[]}async match(e){try{let t=se(this,Dt).call(this,{operation:"read"});if(!t)return;let r=Zs(e),n=`${t.url}/${ea(r)}`,o=await fetch(n,{headers:this[oo](t),method:"GET"});return o.ok?o:void 0}catch{}}async matchAll(e,t){if(!e)return[];let r=await this.match(e);return r?[r]:[]}async put(e,t){var s,a,i;if(!t.ok)throw new TypeError(`Cannot cache response with status ${t.status}.`);if(e instanceof Request&&e.method!=="GET")throw new TypeError(`Cannot cache response to ${e.method} request.`);if(t.status===206)throw new TypeError("Cannot cache response to a range request (206 Partial Content).");if((s=t.headers.get("vary"))!=null&&s.includes("*"))throw new TypeError("Cannot cache response with 'Vary: *' header.");let r=se(this,Dt).call(this,{operation:"write"});if(!r)return;let n=Zs(e),o=await fetch(`${r.url}/${ea(n)}`,{body:t.body,headers:{...this[oo](r),[sR]:this[Up](t.headers),[aR]:t.status.toString()},duplex:"half",method:"POST"});if(!o.ok){let E=((a=o.headers)==null?void 0:a.get(oR))??"",_=rR[E]||nR;(i=r.logger)==null||i.call(r,`Failed to write to the cache: ${_}`)}}};Dt=new WeakMap;so=new WeakMap;Lr=new WeakMap;var Zs=e=>{let t;if(e instanceof Request)t=new URL(e.url);else try{t=new URL(String(e))}catch{throw new TypeError(`${e} is not a valid URL.`)}if(!Dp.has(t.protocol))throw new TypeError(`Cannot cache response for URL with unsupported protocol (${t.protocol}). Supported protocols are ${[...Dp].join(", ")}.`);return t},ea=e=>encodeURIComponent(e.toString()),ao,De,Vp=class{constructor(e){Cr(this,ao),Cr(this,De),Ir(this,ao,e),Ir(this,De,new Map)}open(e){let t=se(this,De).get(e);return t||(t=new pR({...se(this,ao),name:e}),se(this,De).set(e,t)),Promise.resolve(t)}has(e){return Promise.resolve(se(this,De).has(e))}delete(e){return Promise.resolve(se(this,De).delete(e))}keys(){return Promise.resolve([...se(this,De).keys()])}async match(e,t){var r;if(t!=null&&t.cacheName)return(r=se(this,De).get(t.cacheName))==null?void 0:r.match(e);for(let n of se(this,De).values())if(await n.match(e)===void 0)return}};ao=new WeakMap;De=new WeakMap;var Ut=class e extends Error{constructor(t){super(t),this.name="NetlifyUserError",Object.setPrototypeOf(this,e.prototype)}};var TR={"cache-api-read":100,"cache-api-write":20},Eo=class{constructor(t=TR){this.counts=new Map,this.limits=t}register(t){let r=this.counts.get(t)||0,n=this.limits[t]||0;return r>=n?!1:(this.counts.set(t,r+1),!0)}};import{AsyncLocalStorage as uR}from"async_hooks";var Ae=new uR;import{env as wp}from"process";var _o=()=>!!wp.NETLIFY_DEV||!!wp.NETLIFY_LOCAL;var SR=null,ta=()=>SR??console.log;var Gp="__nfSystemLog",yt=(e,t)=>{_o()||ta()(Gp,{msg:e,fields:t})},ra=e=>{ta()(Gp,JSON.stringify(e))};var Bp=(e,t,r)=>!t||!r?null:{host:new URL(e).hostname,token:t,url:new URL("/.netlify/cache",r).toString()},lR=()=>{globalThis.caches=new Vp({getContext:({operation:e})=>{let t=Ae.getStore();if(!(t!=null&&t.operationCounter))throw new Ut("The Cache API must be used within the scope of the request handler. Refer to https://ntl.fyi/cache-api-scope for more information.");let{cacheAPI:r,operationCounter:n}=t,o=e===io.Delete||e===io.Write?"cache-api-write":"cache-api-read";return n.register(o)?r||(yt("missing Cache API metadata in request"),null):(console.log(`You've exceeded the number of allowed Cache API ${o==="cache-api-write"?"writes":"reads"} for a single invocation. Refer to https://ntl.fyi/cache-api-limits for more information.`),null)},userAgent:"netlify-functions"})};lR();var Hp="x-nf-client-connection-ip",Fp="x-nf-geo",Yp="x-nf-account-id",co="x-nf-deploy-id",$p="x-nf-deploy-context",kp="x-nf-deploy-published",qp="x-nf-site-id",jp="x-nf-request-flags",po="x-nf-invocation-metadata",Kp="x-nf-request-id",Xp="x-nf-start-timestamp",Wp="x-nf-trace-span-id",zp="x-nf-request-start",Jp="x-nf-fetch-timing";var To=e=>({id:e.headers.get(Yp)??""});var uo=({headers:e,skewProtectionToken:t})=>({context:e.get($p)??"",id:e.get(co)??"",published:e.get(kp)==="1",skewProtectionToken:t});var lo=Symbol("Request flags"),Mr=Symbol("Request route"),AR=Symbol.for("$netlify.requestNodePrimitives"),fR=typeof Request>"u"?class{}:Request,Qp,So=class extends(Qp=fR,lo,Mr,AR,Qp){},Zp=e=>{let t=[];for(let r of e.fetchCalls){let o=((r.end??performance.now())-r.start).toFixed(1),s=o.endsWith(".0")?o.split(".")[0]:o;t.push(`${r.host};dur=${s}`)}return t};var bt,Dr,xr=class{constructor(t){w(this,bt);w(this,Dr);b(this,bt,new Set),b(this,Dr,t)}get(t){let r=u(this,Dr)[t];return r!==void 0&&u(this,bt).add(t),r}get evaluations(){return u(this,bt)}};bt=new WeakMap,Dr=new WeakMap;var eT=e=>e[lo]??new xr({}),tT=(e,t)=>{e[lo]=t};import{Buffer as rT}from"buffer";var nT=e=>{if(!e)return null;try{return JSON.parse(rT.from(e,"base64").toString("utf8"))}catch{return null}},oT=e=>rT.from(JSON.stringify(e)).toString("base64"),na=e=>e&&typeof e=="object"&&"default"in e?e.default:e,sT=async e=>{let t=0;for(;e.enqueuedPromises.size!==0;)await Promise.allSettled(e.enqueuedPromises),++t>=1e3&&(t=0,await new Promise(r=>{setTimeout(r,0)}))};var aT=e=>{let t=nT(e);if(!t)return{};let{postal_code:r,...n}=t;return Object.fromEntries(Object.entries({...n,postalCode:r}).filter(([,s])=>s!==void 0))};var iT=e=>e??"";var dR=Object.defineProperty,h=(e,t)=>dR(e,"name",{value:t,configurable:!0}),Bt=class{type=3;name="";prefix="";value="";suffix="";modifier=3;constructor(e,t,r,n,o,s){this.type=e,this.name=t,this.prefix=r,this.value=n,this.suffix=o,this.modifier=s}hasCustomName(){return this.name!==""&&typeof this.name!="number"}};h(Bt,"Part");var RR=/[$_\p{ID_Start}]/u,hR=/[$_\u200C\u200D\p{ID_Continue}]/u,sa=".*";function cT(e,t){return(t?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}h(cT,"isASCII");function ca(e,t=!1){let r=[],n=0;for(;n<e.length;){let o=e[n],s=h(function(a){if(!t)throw new TypeError(a);r.push({type:"INVALID_CHAR",index:n,value:e[n++]})},"ErrorOrInvalid");if(o==="*"){r.push({type:"ASTERISK",index:n,value:e[n++]});continue}if(o==="+"||o==="?"){r.push({type:"OTHER_MODIFIER",index:n,value:e[n++]});continue}if(o==="\\"){r.push({type:"ESCAPED_CHAR",index:n++,value:e[n++]});continue}if(o==="{"){r.push({type:"OPEN",index:n,value:e[n++]});continue}if(o==="}"){r.push({type:"CLOSE",index:n,value:e[n++]});continue}if(o===":"){let a="",i=n+1;for(;i<e.length;){let E=e.substr(i,1);if(i===n+1&&RR.test(E)||i!==n+1&&hR.test(E)){a+=e[i++];continue}break}if(!a){s(`Missing parameter name at ${n}`);continue}r.push({type:"NAME",index:n,value:a}),n=i;continue}if(o==="("){let a=1,i="",E=n+1,_=!1;if(e[E]==="?"){s(`Pattern cannot start with "?" at ${E}`);continue}for(;E<e.length;){if(!cT(e[E],!1)){s(`Invalid character '${e[E]}' at ${E}.`),_=!0;break}if(e[E]==="\\"){i+=e[E++]+e[E++];continue}if(e[E]===")"){if(a--,a===0){E++;break}}else if(e[E]==="("&&(a++,e[E+1]!=="?")){s(`Capturing groups are not allowed at ${E}`),_=!0;break}i+=e[E++]}if(_)continue;if(a){s(`Unbalanced pattern at ${n}`);continue}if(!i){s(`Missing pattern at ${n}`);continue}r.push({type:"REGEX",index:n,value:i}),n=E;continue}r.push({type:"CHAR",index:n,value:e[n++]})}return r.push({type:"END",index:n,value:""}),r}h(ca,"lexer");function pa(e,t={}){let r=ca(e);t.delimiter??(t.delimiter="/#?"),t.prefixes??(t.prefixes="./");let n=`[^${_e(t.delimiter)}]+?`,o=[],s=0,a=0,i="",E=new Set,_=h(U=>{if(a<r.length&&r[a].type===U)return r[a++].value},"tryConsume"),c=h(()=>_("OTHER_MODIFIER")??_("ASTERISK"),"tryConsumeModifier"),T=h(U=>{let k=_(U);if(k!==void 0)return k;let{type:M,index:de}=r[a];throw new TypeError(`Unexpected ${M} at ${de}, expected ${U}`)},"mustConsume"),l=h(()=>{let U="",k;for(;k=_("CHAR")??_("ESCAPED_CHAR");)U+=k;return U},"consumeText"),f=h(U=>U,"DefaultEncodePart"),C=t.encodePart||f,V="",q=h(U=>{V+=U},"appendToPendingFixedValue"),re=h(()=>{V.length&&(o.push(new Bt(3,"","",C(V),"",3)),V="")},"maybeAddPartFromPendingFixedValue"),pe=h((U,k,M,de,ve)=>{let ae=3;switch(ve){case"?":ae=1;break;case"*":ae=0;break;case"+":ae=2;break}if(!k&&!M&&ae===3){q(U);return}if(re(),!k&&!M){if(!U)return;o.push(new Bt(3,"","",C(U),"",ae));return}let G;M?M==="*"?G=sa:G=M:G=n;let Fe=2;G===n?(Fe=1,G=""):G===sa&&(Fe=0,G="");let Re;if(k?Re=k:M&&(Re=s++),E.has(Re))throw new TypeError(`Duplicate name '${Re}'.`);E.add(Re),o.push(new Bt(Fe,Re,C(U),G,C(de),ae))},"addPart");for(;a<r.length;){let U=_("CHAR"),k=_("NAME"),M=_("REGEX");if(!k&&!M&&(M=_("ASTERISK")),k||M){let ve=U??"";t.prefixes.indexOf(ve)===-1&&(q(ve),ve=""),re();let ae=c();pe(ve,k,M,"",ae);continue}let de=U??_("ESCAPED_CHAR");if(de){q(de);continue}if(_("OPEN")){let ve=l(),ae=_("NAME"),G=_("REGEX");!ae&&!G&&(G=_("ASTERISK"));let Fe=l();T("CLOSE");let Re=c();pe(ve,ae,G,Fe,Re);continue}re(),T("END")}return o}h(pa,"parse");function _e(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}h(_e,"escapeString");function aa(e){return e&&e.ignoreCase?"ui":"u"}h(aa,"flags");function pT(e,t,r){return Ta(pa(e,r),t,r)}h(pT,"stringToRegexp");function _t(e){switch(e){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}h(_t,"modifierToString");function Ta(e,t,r={}){r.delimiter??(r.delimiter="/#?"),r.prefixes??(r.prefixes="./"),r.sensitive??(r.sensitive=!1),r.strict??(r.strict=!1),r.end??(r.end=!0),r.start??(r.start=!0),r.endsWith="";let n=r.start?"^":"";for(let i of e){if(i.type===3){i.modifier===3?n+=_e(i.value):n+=`(?:${_e(i.value)})${_t(i.modifier)}`;continue}t&&t.push(i.name);let E=`[^${_e(r.delimiter)}]+?`,_=i.value;if(i.type===1?_=E:i.type===0&&(_=sa),!i.prefix.length&&!i.suffix.length){i.modifier===3||i.modifier===1?n+=`(${_})${_t(i.modifier)}`:n+=`((?:${_})${_t(i.modifier)})`;continue}if(i.modifier===3||i.modifier===1){n+=`(?:${_e(i.prefix)}(${_})${_e(i.suffix)})`,n+=_t(i.modifier);continue}n+=`(?:${_e(i.prefix)}`,n+=`((?:${_})(?:`,n+=_e(i.suffix),n+=_e(i.prefix),n+=`(?:${_}))*)${_e(i.suffix)})`,i.modifier===0&&(n+="?")}let o=`[${_e(r.endsWith)}]|$`,s=`[${_e(r.delimiter)}]`;if(r.end)return r.strict||(n+=`${s}?`),r.endsWith.length?n+=`(?=${o})`:n+="$",new RegExp(n,aa(r));r.strict||(n+=`(?:${s}(?=${o}))?`);let a=!1;if(e.length){let i=e[e.length-1];i.type===3&&i.modifier===3&&(a=r.delimiter.indexOf(i)>-1)}return a||(n+=`(?=${s}|${o})`),new RegExp(n,aa(r))}h(Ta,"partsToRegexp");var We={delimiter:"",prefixes:"",sensitive:!0,strict:!0},mR={delimiter:".",prefixes:"",sensitive:!0,strict:!0},OR={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function TT(e,t){return e.length?e[0]==="/"?!0:!t||e.length<2?!1:(e[0]=="\\"||e[0]=="{")&&e[1]=="/":!1}h(TT,"isAbsolutePathname");function ua(e,t){return e.startsWith(t)?e.substring(t.length,e.length):e}h(ua,"maybeStripPrefix");function uT(e,t){return e.endsWith(t)?e.substr(0,e.length-t.length):e}h(uT,"maybeStripSuffix");function Sa(e){return!e||e.length<2?!1:e[0]==="["||(e[0]==="\\"||e[0]==="{")&&e[1]==="["}h(Sa,"treatAsIPv6Hostname");var ST=["ftp","file","http","https","ws","wss"];function la(e){if(!e)return!0;for(let t of ST)if(e.test(t))return!0;return!1}h(la,"isSpecialScheme");function lT(e,t){if(e=ua(e,"#"),t||e==="")return e;let r=new URL("https://example.com");return r.hash=e,r.hash?r.hash.substring(1,r.hash.length):""}h(lT,"canonicalizeHash");function AT(e,t){if(e=ua(e,"?"),t||e==="")return e;let r=new URL("https://example.com");return r.search=e,r.search?r.search.substring(1,r.search.length):""}h(AT,"canonicalizeSearch");function fT(e,t){return t||e===""?e:Sa(e)?da(e):fa(e)}h(fT,"canonicalizeHostname");function dT(e,t){if(t||e==="")return e;let r=new URL("https://example.com");return r.password=e,r.password}h(dT,"canonicalizePassword");function RT(e,t){if(t||e==="")return e;let r=new URL("https://example.com");return r.username=e,r.username}h(RT,"canonicalizeUsername");function hT(e,t,r){if(r||e==="")return e;if(t&&!ST.includes(t))return new URL(`${t}:${e}`).pathname;let n=e[0]=="/";return e=new URL(n?e:"/-"+e,"https://example.com").pathname,n||(e=e.substring(2,e.length)),e}h(hT,"canonicalizePathname");function mT(e,t,r){return Aa(t)===e&&(e=""),r||e===""?e:Ra(e)}h(mT,"canonicalizePort");function OT(e,t){return e=uT(e,":"),t||e===""?e:ho(e)}h(OT,"canonicalizeProtocol");function Aa(e){switch(e){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}h(Aa,"defaultPortForProtocol");function ho(e){if(e==="")return e;if(/^[-+.A-Za-z0-9]*$/.test(e))return e.toLowerCase();throw new TypeError(`Invalid protocol '${e}'.`)}h(ho,"protocolEncodeCallback");function NT(e){if(e==="")return e;let t=new URL("https://example.com");return t.username=e,t.username}h(NT,"usernameEncodeCallback");function vT(e){if(e==="")return e;let t=new URL("https://example.com");return t.password=e,t.password}h(vT,"passwordEncodeCallback");function fa(e){if(e==="")return e;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(e))throw new TypeError(`Invalid hostname '${e}'`);let t=new URL("https://example.com");return t.hostname=e,t.hostname}h(fa,"hostnameEncodeCallback");function da(e){if(e==="")return e;if(/[^0-9a-fA-F[\]:]/g.test(e))throw new TypeError(`Invalid IPv6 hostname '${e}'`);return e.toLowerCase()}h(da,"ipv6HostnameEncodeCallback");function Ra(e){if(e===""||/^[0-9]*$/.test(e)&&parseInt(e)<=65535)return e;throw new TypeError(`Invalid port '${e}'.`)}h(Ra,"portEncodeCallback");function PT(e){if(e==="")return e;let t=new URL("https://example.com");return t.pathname=e[0]!=="/"?"/-"+e:e,e[0]!=="/"?t.pathname.substring(2,t.pathname.length):t.pathname}h(PT,"standardURLPathnameEncodeCallback");function gT(e){return e===""?e:new URL(`data:${e}`).pathname}h(gT,"pathURLPathnameEncodeCallback");function LT(e){if(e==="")return e;let t=new URL("https://example.com");return t.search=e,t.search.substring(1,t.search.length)}h(LT,"searchEncodeCallback");function CT(e){if(e==="")return e;let t=new URL("https://example.com");return t.hash=e,t.hash.substring(1,t.hash.length)}h(CT,"hashEncodeCallback");var Ht,te,Y,D,ct,Ft,ce,Yt,$t,kt,S,H,MT,ia,Ur,Ao,fe,Ea,xT,fo,DT,UT,Ro,Vt,Et,yT,bT,VT,wT,Ue,GT,ET,IT=(ET=class{constructor(e){w(this,S);w(this,Ht);w(this,te,[]);w(this,Y,{});w(this,D,0);w(this,ct,1);w(this,Ft,0);w(this,ce,0);w(this,Yt,0);w(this,$t,0);w(this,kt,!1);b(this,Ht,e)}get result(){return u(this,Y)}parse(){for(b(this,te,ca(u(this,Ht),!0));u(this,D)<u(this,te).length;b(this,D,u(this,D)+u(this,ct))){if(b(this,ct,1),u(this,te)[u(this,D)].type==="END"){if(u(this,ce)===0){A(this,S,ia).call(this),A(this,S,Et).call(this)?A(this,S,H).call(this,9,1):A(this,S,Vt).call(this)?A(this,S,H).call(this,8,1):A(this,S,H).call(this,7,0);continue}else if(u(this,ce)===2){A(this,S,Ur).call(this,5);continue}A(this,S,H).call(this,10,0);break}if(u(this,Yt)>0)if(A(this,S,bT).call(this))b(this,Yt,u(this,Yt)-1);else continue;if(A(this,S,yT).call(this)){b(this,Yt,u(this,Yt)+1);continue}switch(u(this,ce)){case 0:A(this,S,Ea).call(this)&&A(this,S,Ur).call(this,1);break;case 1:if(A(this,S,Ea).call(this)){A(this,S,GT).call(this);let e=7,t=1;A(this,S,xT).call(this)?(e=2,t=3):u(this,kt)&&(e=2),A(this,S,H).call(this,e,t)}break;case 2:A(this,S,fo).call(this)?A(this,S,Ur).call(this,3):(A(this,S,Ro).call(this)||A(this,S,Vt).call(this)||A(this,S,Et).call(this))&&A(this,S,Ur).call(this,5);break;case 3:A(this,S,DT).call(this)?A(this,S,H).call(this,4,1):A(this,S,fo).call(this)&&A(this,S,H).call(this,5,1);break;case 4:A(this,S,fo).call(this)&&A(this,S,H).call(this,5,1);break;case 5:A(this,S,VT).call(this)?b(this,$t,u(this,$t)+1):A(this,S,wT).call(this)&&b(this,$t,u(this,$t)-1),A(this,S,UT).call(this)&&!u(this,$t)?A(this,S,H).call(this,6,1):A(this,S,Ro).call(this)?A(this,S,H).call(this,7,0):A(this,S,Vt).call(this)?A(this,S,H).call(this,8,1):A(this,S,Et).call(this)&&A(this,S,H).call(this,9,1);break;case 6:A(this,S,Ro).call(this)?A(this,S,H).call(this,7,0):A(this,S,Vt).call(this)?A(this,S,H).call(this,8,1):A(this,S,Et).call(this)&&A(this,S,H).call(this,9,1);break;case 7:A(this,S,Vt).call(this)?A(this,S,H).call(this,8,1):A(this,S,Et).call(this)&&A(this,S,H).call(this,9,1);break;case 8:A(this,S,Et).call(this)&&A(this,S,H).call(this,9,1);break;case 9:break;case 10:break}}u(this,Y).hostname!==void 0&&u(this,Y).port===void 0&&(u(this,Y).port="")}},Ht=new WeakMap,te=new WeakMap,Y=new WeakMap,D=new WeakMap,ct=new WeakMap,Ft=new WeakMap,ce=new WeakMap,Yt=new WeakMap,$t=new WeakMap,kt=new WeakMap,S=new WeakSet,H=function(e,t){var r,n,o;switch(u(this,ce)){case 0:break;case 1:u(this,Y).protocol=A(this,S,Ue).call(this);break;case 2:break;case 3:u(this,Y).username=A(this,S,Ue).call(this);break;case 4:u(this,Y).password=A(this,S,Ue).call(this);break;case 5:u(this,Y).hostname=A(this,S,Ue).call(this);break;case 6:u(this,Y).port=A(this,S,Ue).call(this);break;case 7:u(this,Y).pathname=A(this,S,Ue).call(this);break;case 8:u(this,Y).search=A(this,S,Ue).call(this);break;case 9:u(this,Y).hash=A(this,S,Ue).call(this);break;case 10:break}u(this,ce)!==0&&e!==10&&([1,2,3,4].includes(u(this,ce))&&[6,7,8,9].includes(e)&&((r=u(this,Y)).hostname??(r.hostname="")),[1,2,3,4,5,6].includes(u(this,ce))&&[8,9].includes(e)&&((n=u(this,Y)).pathname??(n.pathname=u(this,kt)?"/":"")),[1,2,3,4,5,6,7].includes(u(this,ce))&&e===9&&((o=u(this,Y)).search??(o.search=""))),A(this,S,MT).call(this,e,t)},MT=function(e,t){b(this,ce,e),b(this,Ft,u(this,D)+t),b(this,D,u(this,D)+t),b(this,ct,0)},ia=function(){b(this,D,u(this,Ft)),b(this,ct,0)},Ur=function(e){A(this,S,ia).call(this),b(this,ce,e)},Ao=function(e){return e<0&&(e=u(this,te).length-e),e<u(this,te).length?u(this,te)[e]:u(this,te)[u(this,te).length-1]},fe=function(e,t){let r=A(this,S,Ao).call(this,e);return r.value===t&&(r.type==="CHAR"||r.type==="ESCAPED_CHAR"||r.type==="INVALID_CHAR")},Ea=function(){return A(this,S,fe).call(this,u(this,D),":")},xT=function(){return A(this,S,fe).call(this,u(this,D)+1,"/")&&A(this,S,fe).call(this,u(this,D)+2,"/")},fo=function(){return A(this,S,fe).call(this,u(this,D),"@")},DT=function(){return A(this,S,fe).call(this,u(this,D),":")},UT=function(){return A(this,S,fe).call(this,u(this,D),":")},Ro=function(){return A(this,S,fe).call(this,u(this,D),"/")},Vt=function(){if(A(this,S,fe).call(this,u(this,D),"?"))return!0;if(u(this,te)[u(this,D)].value!=="?")return!1;let e=A(this,S,Ao).call(this,u(this,D)-1);return e.type!=="NAME"&&e.type!=="REGEX"&&e.type!=="CLOSE"&&e.type!=="ASTERISK"},Et=function(){return A(this,S,fe).call(this,u(this,D),"#")},yT=function(){return u(this,te)[u(this,D)].type=="OPEN"},bT=function(){return u(this,te)[u(this,D)].type=="CLOSE"},VT=function(){return A(this,S,fe).call(this,u(this,D),"[")},wT=function(){return A(this,S,fe).call(this,u(this,D),"]")},Ue=function(){let e=u(this,te)[u(this,D)],t=A(this,S,Ao).call(this,u(this,Ft)).index;return u(this,Ht).substring(t,e.index)},GT=function(){let e={};Object.assign(e,We),e.encodePart=ho;let t=pT(A(this,S,Ue).call(this),void 0,e);b(this,kt,la(t))},ET);h(IT,"Parser");var oa=["protocol","username","password","hostname","port","pathname","search","hash"],Xe="*";function _a(e,t){if(typeof e!="string")throw new TypeError("parameter 1 is not of type 'string'.");let r=new URL(e,t);return{protocol:r.protocol.substring(0,r.protocol.length-1),username:r.username,password:r.password,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search!==""?r.search.substring(1,r.search.length):void 0,hash:r.hash!==""?r.hash.substring(1,r.hash.length):void 0}}h(_a,"extractValues");function ye(e,t){return t?Gt(e):e}h(ye,"processBaseURLString");function wt(e,t,r){let n;if(typeof t.baseURL=="string")try{n=new URL(t.baseURL),t.protocol===void 0&&(e.protocol=ye(n.protocol.substring(0,n.protocol.length-1),r)),!r&&t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.username===void 0&&(e.username=ye(n.username,r)),!r&&t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.username===void 0&&t.password===void 0&&(e.password=ye(n.password,r)),t.protocol===void 0&&t.hostname===void 0&&(e.hostname=ye(n.hostname,r)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&(e.port=ye(n.port,r)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.pathname===void 0&&(e.pathname=ye(n.pathname,r)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.pathname===void 0&&t.search===void 0&&(e.search=ye(n.search.substring(1,n.search.length),r)),t.protocol===void 0&&t.hostname===void 0&&t.port===void 0&&t.pathname===void 0&&t.search===void 0&&t.hash===void 0&&(e.hash=ye(n.hash.substring(1,n.hash.length),r))}catch{throw new TypeError(`invalid baseURL '${t.baseURL}'.`)}if(typeof t.protocol=="string"&&(e.protocol=OT(t.protocol,r)),typeof t.username=="string"&&(e.username=RT(t.username,r)),typeof t.password=="string"&&(e.password=dT(t.password,r)),typeof t.hostname=="string"&&(e.hostname=fT(t.hostname,r)),typeof t.port=="string"&&(e.port=mT(t.port,e.protocol,r)),typeof t.pathname=="string"){if(e.pathname=t.pathname,n&&!TT(e.pathname,r)){let o=n.pathname.lastIndexOf("/");o>=0&&(e.pathname=ye(n.pathname.substring(0,o+1),r)+e.pathname)}e.pathname=hT(e.pathname,e.protocol,r)}return typeof t.search=="string"&&(e.search=AT(t.search,r)),typeof t.hash=="string"&&(e.hash=lT(t.hash,r)),e}h(wt,"applyInit");function Gt(e){return e.replace(/([+*?:{}()\\])/g,"\\$1")}h(Gt,"escapePatternString");function BT(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}h(BT,"escapeRegexpString");function HT(e,t){t.delimiter??(t.delimiter="/#?"),t.prefixes??(t.prefixes="./"),t.sensitive??(t.sensitive=!1),t.strict??(t.strict=!1),t.end??(t.end=!0),t.start??(t.start=!0),t.endsWith="";let r=".*",n=`[^${BT(t.delimiter)}]+?`,o=/[$_\u200C\u200D\p{ID_Continue}]/u,s="";for(let a=0;a<e.length;++a){let i=e[a];if(i.type===3){if(i.modifier===3){s+=Gt(i.value);continue}s+=`{${Gt(i.value)}}${_t(i.modifier)}`;continue}let E=i.hasCustomName(),_=!!i.suffix.length||!!i.prefix.length&&(i.prefix.length!==1||!t.prefixes.includes(i.prefix)),c=a>0?e[a-1]:null,T=a<e.length-1?e[a+1]:null;if(!_&&E&&i.type===1&&i.modifier===3&&T&&!T.prefix.length&&!T.suffix.length)if(T.type===3){let l=T.value.length>0?T.value[0]:"";_=o.test(l)}else _=!T.hasCustomName();if(!_&&!i.prefix.length&&c&&c.type===3){let l=c.value[c.value.length-1];_=t.prefixes.includes(l)}_&&(s+="{"),s+=Gt(i.prefix),E&&(s+=`:${i.name}`),i.type===2?s+=`(${i.value})`:i.type===1?E||(s+=`(${n})`):i.type===0&&(!E&&(!c||c.type===3||c.modifier!==3||_||i.prefix!=="")?s+="*":s+=`(${r})`),i.type===1&&E&&i.suffix.length&&o.test(i.suffix[0])&&(s+="\\"),s+=Gt(i.suffix),_&&(s+="}"),i.modifier!==3&&(s+=_t(i.modifier))}return s}h(HT,"partsToPattern");var be,pt,qt,$,Ne,jt,_T,yr=(_T=class{constructor(e={},t,r){w(this,be);w(this,pt,{});w(this,qt,{});w(this,$,{});w(this,Ne,{});w(this,jt,!1);try{let n;if(typeof t=="string"?n=t:r=t,typeof e=="string"){let i=new IT(e);if(i.parse(),e=i.result,n===void 0&&typeof e.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");e.baseURL=n}else{if(!e||typeof e!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(n)throw new TypeError("parameter 1 is not of type 'string'.")}typeof r>"u"&&(r={ignoreCase:!1});let o={ignoreCase:r.ignoreCase===!0};b(this,be,wt({pathname:Xe,protocol:Xe,username:Xe,password:Xe,hostname:Xe,port:Xe,search:Xe,hash:Xe},e,!0)),Aa(u(this,be).protocol)===u(this,be).port&&(u(this,be).port="");let a;for(a of oa){if(!(a in u(this,be)))continue;let i={},E=u(this,be)[a];switch(u(this,qt)[a]=[],a){case"protocol":Object.assign(i,We),i.encodePart=ho;break;case"username":Object.assign(i,We),i.encodePart=NT;break;case"password":Object.assign(i,We),i.encodePart=vT;break;case"hostname":Object.assign(i,mR),Sa(E)?i.encodePart=da:i.encodePart=fa;break;case"port":Object.assign(i,We),i.encodePart=Ra;break;case"pathname":la(u(this,pt).protocol)?(Object.assign(i,OR,o),i.encodePart=PT):(Object.assign(i,We,o),i.encodePart=gT);break;case"search":Object.assign(i,We,o),i.encodePart=LT;break;case"hash":Object.assign(i,We,o),i.encodePart=CT;break}try{u(this,Ne)[a]=pa(E,i),u(this,pt)[a]=Ta(u(this,Ne)[a],u(this,qt)[a],i),u(this,$)[a]=HT(u(this,Ne)[a],i),b(this,jt,u(this,jt)||u(this,Ne)[a].some(_=>_.type===2))}catch{throw new TypeError(`invalid ${a} pattern '${u(this,be)[a]}'.`)}}}catch(n){throw new TypeError(`Failed to construct 'URLPattern': ${n.message}`)}}get[Symbol.toStringTag](){return"URLPattern"}test(e={},t){let r={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof e!="string"&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return!1;try{typeof e=="object"?r=wt(r,e,!1):r=wt(r,_a(e,t),!1)}catch{return!1}let n;for(n of oa)if(!u(this,pt)[n].exec(r[n]))return!1;return!0}exec(e={},t){let r={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof e!="string"&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return;try{typeof e=="object"?r=wt(r,e,!1):r=wt(r,_a(e,t),!1)}catch{return null}let n={};t?n.inputs=[e,t]:n.inputs=[e];let o;for(o of oa){let s=u(this,pt)[o].exec(r[o]);if(!s)return null;let a={};for(let[i,E]of u(this,qt)[o].entries())if(typeof E=="string"||typeof E=="number"){let _=s[i+1];a[E]=_}n[o]={input:r[o]??"",groups:a}}return n}static compareComponent(e,t,r){let n=h((i,E)=>{for(let _ of["type","modifier","prefix","value","suffix"]){if(i[_]<E[_])return-1;if(i[_]!==E[_])return 1}return 0},"comparePart"),o=new Bt(3,"","","","",3),s=new Bt(0,"","","","",3),a=h((i,E)=>{let _=0;for(;_<Math.min(i.length,E.length);++_){let c=n(i[_],E[_]);if(c)return c}return i.length===E.length?0:n(i[_]??o,E[_]??o)},"comparePartList");return!u(t,$)[e]&&!u(r,$)[e]?0:u(t,$)[e]&&!u(r,$)[e]?a(u(t,Ne)[e],[s]):!u(t,$)[e]&&u(r,$)[e]?a([s],u(r,Ne)[e]):a(u(t,Ne)[e],u(r,Ne)[e])}get protocol(){return u(this,$).protocol}get username(){return u(this,$).username}get password(){return u(this,$).password}get hostname(){return u(this,$).hostname}get port(){return u(this,$).port}get pathname(){return u(this,$).pathname}get search(){return u(this,$).search}get hash(){return u(this,$).hash}get hasRegExpGroups(){return u(this,jt)}},be=new WeakMap,pt=new WeakMap,qt=new WeakMap,$=new WeakMap,Ne=new WeakMap,jt=new WeakMap,_T);h(yr,"URLPattern");globalThis.URLPattern||(globalThis.URLPattern=yr);var FT=(e,t)=>{var a;if(e===void 0)return{};let r=t.endsWith("/")?t.slice(0,-1):t,o=(a=new yr({pathname:e,baseURL:r}).exec(r))==null?void 0:a.pathname.groups;return o?Object.entries(o).reduce((i,[E,_])=>_===void 0?i:{...i,[E]:_},{}):{}};var mo=e=>e.headers.get(Kp)||"";import{env as NR}from"process";var YT=()=>({region:NR.AWS_REGION});import{env as ha}from"process";var $T=()=>({id:ha.SITE_ID,name:ha.SITE_NAME,url:ha.URL});var vR=typeof Response<"u"&&typeof Response.json=="function"?e=>Response.json(e):e=>new Response(JSON.stringify(e),{headers:{"content-type":"application/json"}}),kT=({cookies:e,req:t,skewProtectionToken:r})=>{let n={},o=t[Mr];try{n=FT(o,t.url)}catch{console.log(`Could not parse function route ${o}.`)}let s={enqueuedPromises:new Set};return{context:{account:To(t),cookies:e.getPublicInterface(),deploy:uo({headers:t.headers,skewProtectionToken:r}),flags:eT(t),path:o,geo:aT(t.headers.get(Fp)),ip:iT(t.headers.get(Hp)),json:vR,log:console.log,next:()=>{throw new Error("`context.next` is not implemented for serverless functions")},params:n,requestId:mo(t),rewrite:i=>{let E=PR(i,t.url);return gR(E)},server:YT(),site:$T(),url:new URL(t.url),waitUntil:function(E){if(arguments.length===0)throw new TypeError("waitUntil: At least 1 argument required, but only 0 passed");let _=Promise.resolve(E).catch(c=>console.error(c)).finally(()=>{s.enqueuedPromises.delete(_)});s.enqueuedPromises.add(_)}},state:s}},PR=(e,t)=>{if(e instanceof URL)return e;if(e.startsWith("/")){let r=new URL(t);return r.pathname=e,r}return new URL(e)},gR=async e=>await fetch(e);import jT from"assert";function qT(e){function t(_,c=2){return _.padStart(c,"0")}let r=t(e.getUTCDate().toString()),n=t(e.getUTCHours().toString()),o=t(e.getUTCMinutes().toString()),s=t(e.getUTCSeconds().toString()),a=e.getUTCFullYear(),i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return`${i[e.getUTCDay()]}, ${r} ${E[e.getUTCMonth()]} ${a} ${n}:${o}:${s} GMT`}var LR=/^(?=[\u0020-\u007E]*$)[^()@<>,;:\\"[\]?={}\s]+$/;function CR(e){if(!e.name)return"";let t=[];if(IR(e.name),xR(e.name,e.value),t.push(`${e.name}=${e.value}`),e.name.startsWith("__Secure")&&(e.secure=!0),e.name.startsWith("__Host")&&(e.path="/",e.secure=!0,delete e.domain),e.secure&&t.push("Secure"),e.httpOnly&&t.push("HttpOnly"),typeof e.maxAge=="number"&&Number.isInteger(e.maxAge)&&(jT(e.maxAge>=0,"Max-Age must be an integer superior or equal to 0"),t.push(`Max-Age=${e.maxAge}`)),e.domain&&(DR(e.domain),t.push(`Domain=${e.domain}`)),e.sameSite&&t.push(`SameSite=${e.sameSite}`),e.path&&(MR(e.path),t.push(`Path=${e.path}`)),e.expires){let{expires:r}=e,n=qT(typeof r=="number"?new Date(r):r);t.push(`Expires=${n}`)}return e.unparsed&&t.push(e.unparsed.join("; ")),t.join("; ")}function IR(e){if(e&&!LR.test(e))throw new TypeError(`Invalid cookie name: "${e}".`)}function MR(e){if(e!=null)for(let t=0;t<e.length;t++){let r=e.charAt(t);if(r<" "||r>"~"||r==";")throw new Error(`${e}: Invalid cookie path char '${r}'`)}}function xR(e,t){if(!(t==null||e==null))for(let r=0;r<t.length;r++){let n=t.charAt(r);if(n<"!"||n=='"'||n==","||n==";"||n=="\\"||n=="\x7F")throw new Error(`RFC2616 cookie '${e}' cannot contain character '${n}'`);if(n>"\x80")throw new Error(`RFC2616 cookie '${e}' can only have US-ASCII chars as value${n.charCodeAt(0).toString(16)}`)}}function DR(e){if(e==null)return;let t=e.charAt(0),r=e.charAt(e.length-1);if(t=="-"||r=="."||r=="-")throw new Error(`Invalid first/last char in cookie domain: ${e}`)}function KT(e){let t=e.get("Cookie");if(t!=null){let r={},n=t.split(";");for(let o of n){let[s,...a]=o.split("=");jT(s!=null);let i=s.trim();r[i]=a.join("=")}return r}return{}}function ma(e,t){let r=CR(t);r&&e.append("Set-Cookie",r)}function XT(e,t,r){ma(e,Object.assign({name:t,value:"",expires:new Date(0)},r))}var Oo=class{constructor(t){this.ops=[],this.request=t}apply(t){this.ops.forEach(r=>{switch(r.type){case"delete":XT(t,r.options.name,{domain:r.options.domain,path:r.options.path});break;case"set":ma(t,r.cookie);break;default:}})}delete(t){let r={path:"/"},n=typeof t=="string"?{name:t}:t;this.ops.push({options:{...r,...n},type:"delete"})}get(t){return KT(this.request.headers)[t]}getPublicInterface(){return{delete:this.delete.bind(this),get:this.get.bind(this),set:this.set.bind(this)}}set(t,r){let n;if(typeof t=="string"){if(typeof r!="string")throw new TypeError("You must provide the cookie value as a string to 'cookies.set'");n={name:t,value:r}}else n=t;this.ops.push({cookie:n,type:"set"})}};import{Buffer as Oa}from"buffer";import UR from"process";var yR="/.netlify/ai/",WT="NETLIFY_AI_GATEWAY_KEY",zT="NETLIFY_AI_GATEWAY_URL",bR="NETLIFY_BLOBS_CONTEXT",VR="NETLIFY_BRANCH",wR="NETLIFY_DB_DRIVER",GR="NETLIFY_DB_URL",BR="NETLIFY_PURGE_API_TOKEN",HR=(e,t)=>ze(e)?e:`${t}${yR}`,ze=e=>typeof e=="string"&&e.length!==0,FR=(e,t)=>{try{let r=Oa.from(t,"base64").toString("utf8"),n=JSON.parse(r),o=e[WT],s=e[zT],a=HR(n.url,e.URL);e[zT]=a,e[WT]=n.token;let i=n.envVars??[];for(let{key:E,url:_}of i){let c=e[E],T=e[_],l=ze(c)&&c!==o,f=ze(T)&&T!==s;!l&&!f&&(e[E]=n.token,e[_]=a)}}catch(r){console.error("An internal error occurred while setting up Netlify AI Gateway:",r)}},YR=(e,t,r)=>{try{let n=Oa.from(t,"base64").toString("utf8"),o=JSON.parse(n),s=r.get(qp),a=r.get(co);e[bR]=Oa.from(JSON.stringify({edgeURL:o.url,uncachedEdgeURL:o.url_uncached,token:o.token,siteID:s,deployID:a,primaryRegion:o.primary_region})).toString("base64")}catch(n){console.error("An internal error occurred while setting up Netlify Blobs:",n)}},JT=({aiGateway:e,blobs:t,env:r=UR.env,headers:n,invocationMetadata:o,netlifyDBURL:s,purgeAPIToken:a})=>{ze(e)&&FR(r,e),ze(t)&&YR(r,t,n),ze(a)&&(r[BR]=a),ze(o==null?void 0:o.branch)&&(r[VR]=o.branch),ze(s)&&(r[wR]="serverless",r[GR]=s)};var QT=e=>e.headers.get(Wp)??"";var ZT=e=>e.headers.get(zp)??"";var eu=({awsRequestID:e,req:t,branch:r,functionName:n,accountTier:o,logToken:s})=>{let a=new URL(t.url),i=mo(t),E={aws_req_id:e,aid:To(t).id,branch:r??"",account_tier:o??"",did:uo({headers:t.headers}).id,fn:n??"",host:a.host,log_token:s,method:t.method,nf_req_id:i,ts:Date.now(),path:a.pathname,span_id:QT(t),req_start_at:ZT(t)};ra({fields:E,type:"bootstrap/request"})},Na=({awsRequestID:e,result:t})=>{let r={aws_req_id:e};t instanceof Response?r.status=t.status:t instanceof Error?r.error_message=t.message:r.status=204,ra({fields:r,type:"bootstrap/response"})};import $R from"process";var tu=({cookies:e,featureFlags:t,requestContext:r,result:n,startTimestamp:o})=>{let s={version:$R.version},a=oT(s);if(n instanceof Response){let i=new Headers(n.headers);e.apply(i);let{body:E,status:_}=n,c=t.evaluations;c.size!==0&&i.set(jp,[...c].join(",")),i.set(po,a),i.set(Xp,o.toString());for(let T of Zp(r))i.append(Jp,T);return{invocationMetadataHeader:a,response:new Response(E,{headers:i,status:_})}}if(n===void 0)return{invocationMetadataHeader:a};throw new Ut("Function returned an unsupported value. Accepted types are 'Response' or 'undefined'")};var ru=!1,kR=e=>(...t)=>{let[r,n]=t;if(typeof r=="string"&&r.startsWith("/"))try{let o=Ae.getStore(),s=o==null?void 0:o.context.url;if(!s)throw new Error("Could not find request in context");let a=new URL(r,s);return e(a,n)}catch{yt("An error occurred in the patched Response.redirect")}return e(...t)},nu=()=>{ru||(ru=!0,"Response"in globalThis&&Response.redirect&&(Response.redirect=kR(Response.redirect)))};import{Buffer as qR}from"buffer";var ou=(e,t)=>{if(!(e==null||e===""))return t?qR.from(e,"base64"):e};var jR=255,su=e=>{let t=new Headers;return Object.entries(e).forEach(([r,n])=>{if(n!==void 0)try{t.set(r.toLowerCase(),n)}catch(o){if([...n].every(a=>a.codePointAt(0)<=jR))throw o;console.warn(`Discarded request header '${r}' because it contains non-ASCII characters`)}}),t},au=e=>{let t={};for(let[r,n]of e.entries())r in t?t[r].push(n):t[r]=[n];return t};import KR from"http";import XR from"https";var WR=globalThis.fetch,iu=e=>{let t=Ae.getStore();if(t!=null&&t.cdnLoopHeader){if(e.headersSent){yt("Headers already sent, cannot add CDN-Loop header");return}e.setHeader("CDN-Loop",t==null?void 0:t.cdnLoopHeader)}};globalThis.fetch=async function(t,r){let n=new Request(t,r),o=new URL(n.url),s=Ae.getStore();s!=null&&s.cdnLoopHeader&&n.headers.set("CDN-Loop",s.cdnLoopHeader);let i={start:performance.now(),host:o.host};try{return await WR(n)}finally{i.end=performance.now(),s==null||s.fetchCalls.push(i)}};for(let e of[KR,XR]){let t=e.request;e.get=function(...n){let o=t(...n);return iu(o),o.end(),o},e.request=function(...n){let o=t(...n);return iu(o),o}}var th=eh(QR),rh=20,nh=e=>awslambda.streamifyResponse(async(t,r,n)=>{var ga,La;let o=Date.now(),s=n.awsRequestId,{aiGateway:a,blobs:i,body:E,flags:_,headers:c,httpMethod:T,invocationMetadata:l,isBase64Encoded:f,logToken:C,netlifyDBURL:V,pcToken:q,pcURL:re,rawUrl:pe,route:U,skewProtectionToken:k}=t,M=new xr(_||{}),de=su(c),ve=ou(E,f),ae=M.get("serverless_functions_abort_signal")===!0?AbortSignal.timeout(n.getRemainingTimeInMillis()-rh):void 0,G=new So(pe,{body:ve,headers:de,method:T,signal:ae}),Fe=!_o()&&M.get("serverless_functions_log_metadata")===!0;M.get("serverless_functions_response_redirect_relative")===!0&&nu(),Fe&&eu({awsRequestID:s,branch:l==null?void 0:l.branch,functionName:l==null?void 0:l.function_name,accountTier:l==null?void 0:l.account_tier,logToken:C,req:G}),JT({aiGateway:a,blobs:i,headers:de,invocationMetadata:l,netlifyDBURL:V,purgeAPIToken:(La=(ga=n==null?void 0:n.clientContext)==null?void 0:ga.custom)==null?void 0:La.purge_api_token}),tT(G,M),U&&(G[Mr]=U),M.get("serverless_functions_wait_event_loop")===!0&&(n.callbackWaitsForEmptyEventLoop=!1);let Re=new Oo(G),{context:va,state:lu}=kT({cookies:Re,req:G,skewProtectionToken:k}),Au={cacheAPI:Bp(pe,q,re),cdnLoopHeader:de.get("cdn-loop"),context:va,operationCounter:new Eo,fetchCalls:[]},Pa=()=>sh({funcOrFuncPath:e,requestContext:Au,req:G,logMetadata:Fe,awsRequestID:s,responseStream:r,cookies:Re,featureFlags:M,state:lu,startTimestamp:o});if(G.headers.has("x-nf-enable-otel")){await oh(va);let{context:Ca,W3CTraceContextPropagator:fu}=await Promise.resolve().then(()=>(_u(),Eu)),du=new fu,Ru={keys:go=>[...go.keys()],get:(go,mu)=>go.get(mu)||void 0},hu=du.extract(Ca.active(),de,Ru);await Ca.with(hu,Pa)}else await Pa()}),oh=async e=>{let{FetchInstrumentation:t}=await Promise.resolve().then(()=>(pu(),cu)),{HttpInstrumentation:r}=await Promise.resolve().then(()=>(uu(),Tu)),n=[/authorization|x-.*|via|alt-svc|server/];Mp({serviceName:e.site.name||"",serviceVersion:e.deploy.id,deploymentEnvironment:e.deploy.context,siteUrl:e.site.url||"",siteId:e.site.id||"",siteName:e.site.name||"",instrumentations:[new t({skipHeaders:n}),new r({skipHeaders:n})]})},sh=async({funcOrFuncPath:e,requestContext:t,req:r,logMetadata:n,awsRequestID:o,responseStream:s,cookies:a,featureFlags:i,state:E,startTimestamp:_})=>{try{let c;if(typeof e=="string"){let C=await import(e),V=na(na(C));c=await Ae.run(t,()=>V(r,t.context))}else c=await Ae.run(t,()=>e.default(r,t.context));n&&Na({awsRequestID:o,result:c});let{invocationMetadataHeader:T,response:l}=tu({cookies:a,featureFlags:i,requestContext:t,result:c,startTimestamp:_});if(l instanceof Response){let C={multiValueHeaders:au(l.headers),statusCode:l.status},V=awslambda.HttpResponseStream.from(s,C);if((i.get("serverless_functions_fix_empty_body")===!0||l.body===null)&&V.write(""),l.body===null){V.end();return}let q=ZR.fromWeb(l.body);await th(q,V);return}let f=awslambda.HttpResponseStream.from(s,{statusCode:204,headers:{[po]:T}});f.write(""),f.end()}catch(c){if(n&&Na({awsRequestID:o,result:c}),c instanceof TypeError&&c.message.includes("ByteString")&&c.message.includes("greater than 255")){let T=`Response header contains a character that is not a Latin-1 character (code point 0-255). Consider encoding the value using encodeURIComponent() or base64. Original error: ${c.message}`;console.error(T);let l=awslambda.HttpResponseStream.from(s,{statusCode:500,headers:{"content-type":"text/plain; charset=utf-8"}});l.write(T),l.end();return}throw c}finally{try{await sT(E)}catch(c){console.error(c)}}};import br from"process";var ah={delete:e=>{delete br.env[e]},get:e=>br.env[e],has:e=>!!br.env[e],set:(e,t)=>{br.env[e]=t},toObject:()=>Object.entries(br.env).reduce((e,[t,r])=>r===void 0?e:{...e,[t]:r},{})},Su={get context(){let e=Ae.getStore();return(e==null?void 0:e.context)??null},env:ah};globalThis.Netlify=Su;var ih=()=>Su;var HM=()=>Eh(import.meta.url);export{nh as getLambdaHandler,ih as getNetlifyGlobal,HM as getPath};
